var xe=Object.create;var Bt=Object.defineProperty;var ke=Object.getOwnPropertyDescriptor;var Ce=Object.getOwnPropertyNames;var Ee=Object.getPrototypeOf,Ie=Object.prototype.hasOwnProperty;var Ne=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),Se=(s,e)=>{for(var t in e)Bt(s,t,{get:e[t],enumerable:!0})},ne=(s,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ce(e))!Ie.call(s,i)&&i!==t&&Bt(s,i,{get:()=>e[i],enumerable:!(n=ke(e,i))||n.enumerable});return s};var Ae=(s,e,t)=>(t=s!=null?xe(Ee(s)):{},ne(e||!s||!s.__esModule?Bt(t,"default",{value:s,enumerable:!0}):t,s)),Te=s=>ne(Bt({},"__esModule",{value:!0}),s);var se=Ne((ie,Gt)=>{(function(s){typeof ie=="object"&&typeof Gt!="undefined"?Gt.exports=s():typeof define=="function"&&define.amd?define([],s):(typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this).JSZip=s()})(function(){return(function s(e,t,n){function i(l,c){if(!t[l]){if(!e[l]){var h=typeof require=="function"&&require;if(!c&&h)return h(l,!0);if(r)return r(l,!0);var g=new Error("Cannot find module '"+l+"'");throw g.code="MODULE_NOT_FOUND",g}var f=t[l]={exports:{}};e[l][0].call(f.exports,function(b){var d=e[l][1][b];return i(d||b)},f,f.exports,s,e,t,n)}return t[l].exports}for(var r=typeof require=="function"&&require,o=0;o<n.length;o++)i(n[o]);return i})({1:[function(s,e,t){"use strict";var n=s("./utils"),i=s("./support"),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(o){for(var l,c,h,g,f,b,d,v=[],p=0,w=o.length,x=w,E=n.getTypeOf(o)!=="string";p<o.length;)x=w-p,h=E?(l=o[p++],c=p<w?o[p++]:0,p<w?o[p++]:0):(l=o.charCodeAt(p++),c=p<w?o.charCodeAt(p++):0,p<w?o.charCodeAt(p++):0),g=l>>2,f=(3&l)<<4|c>>4,b=1<x?(15&c)<<2|h>>6:64,d=2<x?63&h:64,v.push(r.charAt(g)+r.charAt(f)+r.charAt(b)+r.charAt(d));return v.join("")},t.decode=function(o){var l,c,h,g,f,b,d=0,v=0,p="data:";if(o.substr(0,p.length)===p)throw new Error("Invalid base64 input, it looks like a data url.");var w,x=3*(o=o.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(o.charAt(o.length-1)===r.charAt(64)&&x--,o.charAt(o.length-2)===r.charAt(64)&&x--,x%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=i.uint8array?new Uint8Array(0|x):new Array(0|x);d<o.length;)l=r.indexOf(o.charAt(d++))<<2|(g=r.indexOf(o.charAt(d++)))>>4,c=(15&g)<<4|(f=r.indexOf(o.charAt(d++)))>>2,h=(3&f)<<6|(b=r.indexOf(o.charAt(d++))),w[v++]=l,f!==64&&(w[v++]=c),b!==64&&(w[v++]=h);return w}},{"./support":30,"./utils":32}],2:[function(s,e,t){"use strict";var n=s("./external"),i=s("./stream/DataWorker"),r=s("./stream/Crc32Probe"),o=s("./stream/DataLengthProbe");function l(c,h,g,f,b){this.compressedSize=c,this.uncompressedSize=h,this.crc32=g,this.compression=f,this.compressedContent=b}l.prototype={getContentWorker:function(){var c=new i(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),h=this;return c.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new i(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},l.createWorkerFrom=function(c,h,g){return c.pipe(new r).pipe(new o("uncompressedSize")).pipe(h.compressWorker(g)).pipe(new o("compressedSize")).withStreamInfo("compression",h)},e.exports=l},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(s,e,t){"use strict";var n=s("./stream/GenericWorker");t.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},t.DEFLATE=s("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(s,e,t){"use strict";var n=s("./utils"),i=(function(){for(var r,o=[],l=0;l<256;l++){r=l;for(var c=0;c<8;c++)r=1&r?3988292384^r>>>1:r>>>1;o[l]=r}return o})();e.exports=function(r,o){return r!==void 0&&r.length?n.getTypeOf(r)!=="string"?(function(l,c,h,g){var f=i,b=g+h;l^=-1;for(var d=g;d<b;d++)l=l>>>8^f[255&(l^c[d])];return-1^l})(0|o,r,r.length,0):(function(l,c,h,g){var f=i,b=g+h;l^=-1;for(var d=g;d<b;d++)l=l>>>8^f[255&(l^c.charCodeAt(d))];return-1^l})(0|o,r,r.length,0):0}},{"./utils":32}],5:[function(s,e,t){"use strict";t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!0,t.date=null,t.compression=null,t.compressionOptions=null,t.comment=null,t.unixPermissions=null,t.dosPermissions=null},{}],6:[function(s,e,t){"use strict";var n=null;n=typeof Promise!="undefined"?Promise:s("lie"),e.exports={Promise:n}},{lie:37}],7:[function(s,e,t){"use strict";var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",i=s("pako"),r=s("./utils"),o=s("./stream/GenericWorker"),l=n?"uint8array":"array";function c(h,g){o.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=g,this.meta={}}t.magic="\b\0",r.inherits(c,o),c.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(r.transformTo(l,h.data),!1)},c.prototype.flush=function(){o.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(g){h.push({data:g,meta:h.meta})}},t.compressWorker=function(h){return new c("Deflate",h)},t.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(s,e,t){"use strict";function n(f,b){var d,v="";for(d=0;d<b;d++)v+=String.fromCharCode(255&f),f>>>=8;return v}function i(f,b,d,v,p,w){var x,E,C=f.file,B=f.compression,O=w!==l.utf8encode,$=r.transformTo("string",w(C.name)),T=r.transformTo("string",l.utf8encode(C.name)),W=C.comment,q=r.transformTo("string",w(W)),_=r.transformTo("string",l.utf8encode(W)),P=T.length!==C.name.length,u=_.length!==W.length,F="",K="",M="",J=C.dir,U=C.date,Y={crc32:0,compressedSize:0,uncompressedSize:0};b&&!d||(Y.crc32=f.crc32,Y.compressedSize=f.compressedSize,Y.uncompressedSize=f.uncompressedSize);var S=0;b&&(S|=8),O||!P&&!u||(S|=2048);var N=0,G=0;J&&(N|=16),p==="UNIX"?(G=798,N|=(function(Z,nt){var lt=Z;return Z||(lt=nt?16893:33204),(65535&lt)<<16})(C.unixPermissions,J)):(G=20,N|=(function(Z){return 63&(Z||0)})(C.dosPermissions)),x=U.getUTCHours(),x<<=6,x|=U.getUTCMinutes(),x<<=5,x|=U.getUTCSeconds()/2,E=U.getUTCFullYear()-1980,E<<=4,E|=U.getUTCMonth()+1,E<<=5,E|=U.getUTCDate(),P&&(K=n(1,1)+n(c($),4)+T,F+="up"+n(K.length,2)+K),u&&(M=n(1,1)+n(c(q),4)+_,F+="uc"+n(M.length,2)+M);var V="";return V+=`
\0`,V+=n(S,2),V+=B.magic,V+=n(x,2),V+=n(E,2),V+=n(Y.crc32,4),V+=n(Y.compressedSize,4),V+=n(Y.uncompressedSize,4),V+=n($.length,2),V+=n(F.length,2),{fileRecord:h.LOCAL_FILE_HEADER+V+$+F,dirRecord:h.CENTRAL_FILE_HEADER+n(G,2)+V+n(q.length,2)+"\0\0\0\0"+n(N,4)+n(v,4)+$+F+q}}var r=s("../utils"),o=s("../stream/GenericWorker"),l=s("../utf8"),c=s("../crc32"),h=s("../signature");function g(f,b,d,v){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=d,this.encodeFileName=v,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(g,o),g.prototype.push=function(f){var b=f.meta.percent||0,d=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,o.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:d?(b+100*(d-v-1))/d:100}}))},g.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var b=this.streamFiles&&!f.file.dir;if(b){var d=i(f,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:d.fileRecord,meta:{percent:0}})}else this.accumulate=!0},g.prototype.closedSource=function(f){this.accumulate=!1;var b=this.streamFiles&&!f.file.dir,d=i(f,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(d.dirRecord),b)this.push({data:(function(v){return h.DATA_DESCRIPTOR+n(v.crc32,4)+n(v.compressedSize,4)+n(v.uncompressedSize,4)})(f),meta:{percent:100}});else for(this.push({data:d.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},g.prototype.flush=function(){for(var f=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var d=this.bytesWritten-f,v=(function(p,w,x,E,C){var B=r.transformTo("string",C(E));return h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(p,2)+n(p,2)+n(w,4)+n(x,4)+n(B.length,2)+B})(this.dirRecords.length,d,f,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},g.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},g.prototype.registerPrevious=function(f){this._sources.push(f);var b=this;return f.on("data",function(d){b.processChunk(d)}),f.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),f.on("error",function(d){b.error(d)}),this},g.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},g.prototype.error=function(f){var b=this._sources;if(!o.prototype.error.call(this,f))return!1;for(var d=0;d<b.length;d++)try{b[d].error(f)}catch(v){}return!0},g.prototype.lock=function(){o.prototype.lock.call(this);for(var f=this._sources,b=0;b<f.length;b++)f[b].lock()},e.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(s,e,t){"use strict";var n=s("../compressions"),i=s("./ZipFileWorker");t.generateWorker=function(r,o,l){var c=new i(o.streamFiles,l,o.platform,o.encodeFileName),h=0;try{r.forEach(function(g,f){h++;var b=(function(w,x){var E=w||x,C=n[E];if(!C)throw new Error(E+" is not a valid compression method !");return C})(f.options.compression,o.compression),d=f.options.compressionOptions||o.compressionOptions||{},v=f.dir,p=f.date;f._compressWorker(b,d).withStreamInfo("file",{name:g,dir:v,date:p,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(c)}),c.entriesCount=h}catch(g){c.error(g)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(s,e,t){"use strict";function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new n;for(var r in this)typeof this[r]!="function"&&(i[r]=this[r]);return i}}(n.prototype=s("./object")).loadAsync=s("./load"),n.support=s("./support"),n.defaults=s("./defaults"),n.version="3.10.1",n.loadAsync=function(i,r){return new n().loadAsync(i,r)},n.external=s("./external"),e.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(s,e,t){"use strict";var n=s("./utils"),i=s("./external"),r=s("./utf8"),o=s("./zipEntries"),l=s("./stream/Crc32Probe"),c=s("./nodejsUtils");function h(g){return new i.Promise(function(f,b){var d=g.decompressed.getContentWorker().pipe(new l);d.on("error",function(v){b(v)}).on("end",function(){d.streamInfo.crc32!==g.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}e.exports=function(g,f){var b=this;return f=n.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:r.utf8decode}),c.isNode&&c.isStream(g)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",g,!0,f.optimizedBinaryString,f.base64).then(function(d){var v=new o(f);return v.load(d),v}).then(function(d){var v=[i.Promise.resolve(d)],p=d.files;if(f.checkCRC32)for(var w=0;w<p.length;w++)v.push(h(p[w]));return i.Promise.all(v)}).then(function(d){for(var v=d.shift(),p=v.files,w=0;w<p.length;w++){var x=p[w],E=x.fileNameStr,C=n.resolve(x.fileNameStr);b.file(C,x.decompressed,{binary:!0,optimizedBinaryString:!0,date:x.date,dir:x.dir,comment:x.fileCommentStr.length?x.fileCommentStr:null,unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions,createFolders:f.createFolders}),x.dir||(b.file(C).unsafeOriginalName=E)}return v.zipComment.length&&(b.comment=v.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(s,e,t){"use strict";var n=s("../utils"),i=s("../stream/GenericWorker");function r(o,l){i.call(this,"Nodejs stream input adapter for "+o),this._upstreamEnded=!1,this._bindStream(l)}n.inherits(r,i),r.prototype._bindStream=function(o){var l=this;(this._stream=o).pause(),o.on("data",function(c){l.push({data:c,meta:{percent:0}})}).on("error",function(c){l.isPaused?this.generatedError=c:l.error(c)}).on("end",function(){l.isPaused?l._upstreamEnded=!0:l.end()})},r.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},r.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=r},{"../stream/GenericWorker":28,"../utils":32}],13:[function(s,e,t){"use strict";var n=s("readable-stream").Readable;function i(r,o,l){n.call(this,o),this._helper=r;var c=this;r.on("data",function(h,g){c.push(h)||c._helper.pause(),l&&l(g)}).on("error",function(h){c.emit("error",h)}).on("end",function(){c.push(null)})}s("../utils").inherits(i,n),i.prototype._read=function(){this._helper.resume()},e.exports=i},{"../utils":32,"readable-stream":16}],14:[function(s,e,t){"use strict";e.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(n,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,i);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,i)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var i=new Buffer(n);return i.fill(0),i},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(s,e,t){"use strict";function n(C,B,O){var $,T=r.getTypeOf(B),W=r.extend(O||{},c);W.date=W.date||new Date,W.compression!==null&&(W.compression=W.compression.toUpperCase()),typeof W.unixPermissions=="string"&&(W.unixPermissions=parseInt(W.unixPermissions,8)),W.unixPermissions&&16384&W.unixPermissions&&(W.dir=!0),W.dosPermissions&&16&W.dosPermissions&&(W.dir=!0),W.dir&&(C=p(C)),W.createFolders&&($=v(C))&&w.call(this,$,!0);var q=T==="string"&&W.binary===!1&&W.base64===!1;O&&O.binary!==void 0||(W.binary=!q),(B instanceof h&&B.uncompressedSize===0||W.dir||!B||B.length===0)&&(W.base64=!1,W.binary=!0,B="",W.compression="STORE",T="string");var _=null;_=B instanceof h||B instanceof o?B:b.isNode&&b.isStream(B)?new d(C,B):r.prepareContent(C,B,W.binary,W.optimizedBinaryString,W.base64);var P=new g(C,_,W);this.files[C]=P}var i=s("./utf8"),r=s("./utils"),o=s("./stream/GenericWorker"),l=s("./stream/StreamHelper"),c=s("./defaults"),h=s("./compressedObject"),g=s("./zipObject"),f=s("./generate"),b=s("./nodejsUtils"),d=s("./nodejs/NodejsStreamInputAdapter"),v=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var B=C.lastIndexOf("/");return 0<B?C.substring(0,B):""},p=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},w=function(C,B){return B=B!==void 0?B:c.createFolders,C=p(C),this.files[C]||n.call(this,C,null,{dir:!0,createFolders:B}),this.files[C]};function x(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var B,O,$;for(B in this.files)$=this.files[B],(O=B.slice(this.root.length,B.length))&&B.slice(0,this.root.length)===this.root&&C(O,$)},filter:function(C){var B=[];return this.forEach(function(O,$){C(O,$)&&B.push($)}),B},file:function(C,B,O){if(arguments.length!==1)return C=this.root+C,n.call(this,C,B,O),this;if(x(C)){var $=C;return this.filter(function(W,q){return!q.dir&&$.test(W)})}var T=this.files[this.root+C];return T&&!T.dir?T:null},folder:function(C){if(!C)return this;if(x(C))return this.filter(function(T,W){return W.dir&&C.test(T)});var B=this.root+C,O=w.call(this,B),$=this.clone();return $.root=O.name,$},remove:function(C){C=this.root+C;var B=this.files[C];if(B||(C.slice(-1)!=="/"&&(C+="/"),B=this.files[C]),B&&!B.dir)delete this.files[C];else for(var O=this.filter(function(T,W){return W.name.slice(0,C.length)===C}),$=0;$<O.length;$++)delete this.files[O[$].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var B,O={};try{if((O=r.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=O.type.toLowerCase(),O.compression=O.compression.toUpperCase(),O.type==="binarystring"&&(O.type="string"),!O.type)throw new Error("No output type specified.");r.checkSupport(O.type),O.platform!=="darwin"&&O.platform!=="freebsd"&&O.platform!=="linux"&&O.platform!=="sunos"||(O.platform="UNIX"),O.platform==="win32"&&(O.platform="DOS");var $=O.comment||this.comment||"";B=f.generateWorker(this,O,$)}catch(T){(B=new o("error")).error(T)}return new l(B,O.type||"string",O.mimeType)},generateAsync:function(C,B){return this.generateInternalStream(C).accumulate(B)},generateNodeStream:function(C,B){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(B)}};e.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(s,e,t){"use strict";e.exports=s("stream")},{stream:void 0}],17:[function(s,e,t){"use strict";var n=s("./DataReader");function i(r){n.call(this,r);for(var o=0;o<this.data.length;o++)r[o]=255&r[o]}s("../utils").inherits(i,n),i.prototype.byteAt=function(r){return this.data[this.zero+r]},i.prototype.lastIndexOfSignature=function(r){for(var o=r.charCodeAt(0),l=r.charCodeAt(1),c=r.charCodeAt(2),h=r.charCodeAt(3),g=this.length-4;0<=g;--g)if(this.data[g]===o&&this.data[g+1]===l&&this.data[g+2]===c&&this.data[g+3]===h)return g-this.zero;return-1},i.prototype.readAndCheckSignature=function(r){var o=r.charCodeAt(0),l=r.charCodeAt(1),c=r.charCodeAt(2),h=r.charCodeAt(3),g=this.readData(4);return o===g[0]&&l===g[1]&&c===g[2]&&h===g[3]},i.prototype.readData=function(r){if(this.checkOffset(r),r===0)return[];var o=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,o},e.exports=i},{"../utils":32,"./DataReader":18}],18:[function(s,e,t){"use strict";var n=s("../utils");function i(r){this.data=r,this.length=r.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(r){this.checkIndex(this.index+r)},checkIndex:function(r){if(this.length<this.zero+r||r<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+r+"). Corrupted zip ?")},setIndex:function(r){this.checkIndex(r),this.index=r},skip:function(r){this.setIndex(this.index+r)},byteAt:function(){},readInt:function(r){var o,l=0;for(this.checkOffset(r),o=this.index+r-1;o>=this.index;o--)l=(l<<8)+this.byteAt(o);return this.index+=r,l},readString:function(r){return n.transformTo("string",this.readData(r))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var r=this.readInt(4);return new Date(Date.UTC(1980+(r>>25&127),(r>>21&15)-1,r>>16&31,r>>11&31,r>>5&63,(31&r)<<1))}},e.exports=i},{"../utils":32}],19:[function(s,e,t){"use strict";var n=s("./Uint8ArrayReader");function i(r){n.call(this,r)}s("../utils").inherits(i,n),i.prototype.readData=function(r){this.checkOffset(r);var o=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,o},e.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(s,e,t){"use strict";var n=s("./DataReader");function i(r){n.call(this,r)}s("../utils").inherits(i,n),i.prototype.byteAt=function(r){return this.data.charCodeAt(this.zero+r)},i.prototype.lastIndexOfSignature=function(r){return this.data.lastIndexOf(r)-this.zero},i.prototype.readAndCheckSignature=function(r){return r===this.readData(4)},i.prototype.readData=function(r){this.checkOffset(r);var o=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,o},e.exports=i},{"../utils":32,"./DataReader":18}],21:[function(s,e,t){"use strict";var n=s("./ArrayReader");function i(r){n.call(this,r)}s("../utils").inherits(i,n),i.prototype.readData=function(r){if(this.checkOffset(r),r===0)return new Uint8Array(0);var o=this.data.subarray(this.zero+this.index,this.zero+this.index+r);return this.index+=r,o},e.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(s,e,t){"use strict";var n=s("../utils"),i=s("../support"),r=s("./ArrayReader"),o=s("./StringReader"),l=s("./NodeBufferReader"),c=s("./Uint8ArrayReader");e.exports=function(h){var g=n.getTypeOf(h);return n.checkSupport(g),g!=="string"||i.uint8array?g==="nodebuffer"?new l(h):i.uint8array?new c(n.transformTo("uint8array",h)):new r(n.transformTo("array",h)):new o(h)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(s,e,t){"use strict";t.LOCAL_FILE_HEADER="PK",t.CENTRAL_FILE_HEADER="PK",t.CENTRAL_DIRECTORY_END="PK",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",t.ZIP64_CENTRAL_DIRECTORY_END="PK",t.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(s,e,t){"use strict";var n=s("./GenericWorker"),i=s("../utils");function r(o){n.call(this,"ConvertWorker to "+o),this.destType=o}i.inherits(r,n),r.prototype.processChunk=function(o){this.push({data:i.transformTo(this.destType,o.data),meta:o.meta})},e.exports=r},{"../utils":32,"./GenericWorker":28}],25:[function(s,e,t){"use strict";var n=s("./GenericWorker"),i=s("../crc32");function r(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}s("../utils").inherits(r,n),r.prototype.processChunk=function(o){this.streamInfo.crc32=i(o.data,this.streamInfo.crc32||0),this.push(o)},e.exports=r},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(s,e,t){"use strict";var n=s("../utils"),i=s("./GenericWorker");function r(o){i.call(this,"DataLengthProbe for "+o),this.propName=o,this.withStreamInfo(o,0)}n.inherits(r,i),r.prototype.processChunk=function(o){if(o){var l=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=l+o.data.length}i.prototype.processChunk.call(this,o)},e.exports=r},{"../utils":32,"./GenericWorker":28}],27:[function(s,e,t){"use strict";var n=s("../utils"),i=s("./GenericWorker");function r(o){i.call(this,"DataWorker");var l=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,o.then(function(c){l.dataIsReady=!0,l.data=c,l.max=c&&c.length||0,l.type=n.getTypeOf(c),l.isPaused||l._tickAndRepeat()},function(c){l.error(c)})}n.inherits(r,i),r.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},r.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},r.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},r.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var o=null,l=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":o=this.data.substring(this.index,l);break;case"uint8array":o=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":o=this.data.slice(this.index,l)}return this.index=l,this.push({data:o,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=r},{"../utils":32,"./GenericWorker":28}],28:[function(s,e,t){"use strict";function n(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,r){return this._listeners[i].push(r),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,r){if(this._listeners[i])for(var o=0;o<this._listeners[i].length;o++)this._listeners[i][o].call(this,r)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var r=this;return i.on("data",function(o){r.processChunk(o)}),i.on("end",function(){r.end()}),i.on("error",function(o){r.error(o)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,r){return this.extraStreamInfo[i]=r,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},e.exports=n},{}],29:[function(s,e,t){"use strict";var n=s("../utils"),i=s("./ConvertWorker"),r=s("./GenericWorker"),o=s("../base64"),l=s("../support"),c=s("../external"),h=null;if(l.nodestream)try{h=s("../nodejs/NodejsStreamOutputAdapter")}catch(b){}function g(b,d){return new c.Promise(function(v,p){var w=[],x=b._internalType,E=b._outputType,C=b._mimeType;b.on("data",function(B,O){w.push(B),d&&d(O)}).on("error",function(B){w=[],p(B)}).on("end",function(){try{var B=(function(O,$,T){switch(O){case"blob":return n.newBlob(n.transformTo("arraybuffer",$),T);case"base64":return o.encode($);default:return n.transformTo(O,$)}})(E,(function(O,$){var T,W=0,q=null,_=0;for(T=0;T<$.length;T++)_+=$[T].length;switch(O){case"string":return $.join("");case"array":return Array.prototype.concat.apply([],$);case"uint8array":for(q=new Uint8Array(_),T=0;T<$.length;T++)q.set($[T],W),W+=$[T].length;return q;case"nodebuffer":return Buffer.concat($);default:throw new Error("concat : unsupported type '"+O+"'")}})(x,w),C);v(B)}catch(O){p(O)}w=[]}).resume()})}function f(b,d,v){var p=d;switch(d){case"blob":case"arraybuffer":p="uint8array";break;case"base64":p="string"}try{this._internalType=p,this._outputType=d,this._mimeType=v,n.checkSupport(p),this._worker=b.pipe(new i(p)),b.lock()}catch(w){this._worker=new r("error"),this._worker.error(w)}}f.prototype={accumulate:function(b){return g(this,b)},on:function(b,d){var v=this;return b==="data"?this._worker.on(b,function(p){d.call(v,p.data,p.meta)}):this._worker.on(b,function(){n.delay(d,arguments,v)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},b)}},e.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(s,e,t){"use strict";if(t.base64=!0,t.array=!0,t.string=!0,t.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",t.nodebuffer=typeof Buffer!="undefined",t.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")t.blob=!1;else{var n=new ArrayBuffer(0);try{t.blob=new Blob([n],{type:"application/zip"}).size===0}catch(r){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(n),t.blob=i.getBlob("application/zip").size===0}catch(o){t.blob=!1}}}try{t.nodestream=!!s("readable-stream").Readable}catch(r){t.nodestream=!1}},{"readable-stream":16}],31:[function(s,e,t){"use strict";for(var n=s("./utils"),i=s("./support"),r=s("./nodejsUtils"),o=s("./stream/GenericWorker"),l=new Array(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;l[254]=l[254]=1;function h(){o.call(this,"utf-8 decode"),this.leftOver=null}function g(){o.call(this,"utf-8 encode")}t.utf8encode=function(f){return i.nodebuffer?r.newBufferFrom(f,"utf-8"):(function(b){var d,v,p,w,x,E=b.length,C=0;for(w=0;w<E;w++)(64512&(v=b.charCodeAt(w)))==55296&&w+1<E&&(64512&(p=b.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(p-56320),w++),C+=v<128?1:v<2048?2:v<65536?3:4;for(d=i.uint8array?new Uint8Array(C):new Array(C),w=x=0;x<C;w++)(64512&(v=b.charCodeAt(w)))==55296&&w+1<E&&(64512&(p=b.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(p-56320),w++),v<128?d[x++]=v:(v<2048?d[x++]=192|v>>>6:(v<65536?d[x++]=224|v>>>12:(d[x++]=240|v>>>18,d[x++]=128|v>>>12&63),d[x++]=128|v>>>6&63),d[x++]=128|63&v);return d})(f)},t.utf8decode=function(f){return i.nodebuffer?n.transformTo("nodebuffer",f).toString("utf-8"):(function(b){var d,v,p,w,x=b.length,E=new Array(2*x);for(d=v=0;d<x;)if((p=b[d++])<128)E[v++]=p;else if(4<(w=l[p]))E[v++]=65533,d+=w-1;else{for(p&=w===2?31:w===3?15:7;1<w&&d<x;)p=p<<6|63&b[d++],w--;1<w?E[v++]=65533:p<65536?E[v++]=p:(p-=65536,E[v++]=55296|p>>10&1023,E[v++]=56320|1023&p)}return E.length!==v&&(E.subarray?E=E.subarray(0,v):E.length=v),n.applyFromCharCode(E)})(f=n.transformTo(i.uint8array?"uint8array":"array",f))},n.inherits(h,o),h.prototype.processChunk=function(f){var b=n.transformTo(i.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var d=b;(b=new Uint8Array(d.length+this.leftOver.length)).set(this.leftOver,0),b.set(d,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var v=(function(w,x){var E;for((x=x||w.length)>w.length&&(x=w.length),E=x-1;0<=E&&(192&w[E])==128;)E--;return E<0||E===0?x:E+l[w[E]]>x?E:x})(b),p=b;v!==b.length&&(i.uint8array?(p=b.subarray(0,v),this.leftOver=b.subarray(v,b.length)):(p=b.slice(0,v),this.leftOver=b.slice(v,b.length))),this.push({data:t.utf8decode(p),meta:f.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:t.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},t.Utf8DecodeWorker=h,n.inherits(g,o),g.prototype.processChunk=function(f){this.push({data:t.utf8encode(f.data),meta:f.meta})},t.Utf8EncodeWorker=g},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(s,e,t){"use strict";var n=s("./support"),i=s("./base64"),r=s("./nodejsUtils"),o=s("./external");function l(d){return d}function c(d,v){for(var p=0;p<d.length;++p)v[p]=255&d.charCodeAt(p);return v}s("setimmediate"),t.newBlob=function(d,v){t.checkSupport("blob");try{return new Blob([d],{type:v})}catch(w){try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return p.append(d),p.getBlob(v)}catch(x){throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(d,v,p){var w=[],x=0,E=d.length;if(E<=p)return String.fromCharCode.apply(null,d);for(;x<E;)v==="array"||v==="nodebuffer"?w.push(String.fromCharCode.apply(null,d.slice(x,Math.min(x+p,E)))):w.push(String.fromCharCode.apply(null,d.subarray(x,Math.min(x+p,E)))),x+=p;return w.join("")},stringifyByChar:function(d){for(var v="",p=0;p<d.length;p++)v+=String.fromCharCode(d[p]);return v},applyCanBeUsed:{uint8array:(function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(d){return!1}})(),nodebuffer:(function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,r.allocBuffer(1)).length===1}catch(d){return!1}})()}};function g(d){var v=65536,p=t.getTypeOf(d),w=!0;if(p==="uint8array"?w=h.applyCanBeUsed.uint8array:p==="nodebuffer"&&(w=h.applyCanBeUsed.nodebuffer),w)for(;1<v;)try{return h.stringifyByChunk(d,p,v)}catch(x){v=Math.floor(v/2)}return h.stringifyByChar(d)}function f(d,v){for(var p=0;p<d.length;p++)v[p]=d[p];return v}t.applyFromCharCode=g;var b={};b.string={string:l,array:function(d){return c(d,new Array(d.length))},arraybuffer:function(d){return b.string.uint8array(d).buffer},uint8array:function(d){return c(d,new Uint8Array(d.length))},nodebuffer:function(d){return c(d,r.allocBuffer(d.length))}},b.array={string:g,array:l,arraybuffer:function(d){return new Uint8Array(d).buffer},uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return r.newBufferFrom(d)}},b.arraybuffer={string:function(d){return g(new Uint8Array(d))},array:function(d){return f(new Uint8Array(d),new Array(d.byteLength))},arraybuffer:l,uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return r.newBufferFrom(new Uint8Array(d))}},b.uint8array={string:g,array:function(d){return f(d,new Array(d.length))},arraybuffer:function(d){return d.buffer},uint8array:l,nodebuffer:function(d){return r.newBufferFrom(d)}},b.nodebuffer={string:g,array:function(d){return f(d,new Array(d.length))},arraybuffer:function(d){return b.nodebuffer.uint8array(d).buffer},uint8array:function(d){return f(d,new Uint8Array(d.length))},nodebuffer:l},t.transformTo=function(d,v){if(v=v||"",!d)return v;t.checkSupport(d);var p=t.getTypeOf(v);return b[p][d](v)},t.resolve=function(d){for(var v=d.split("/"),p=[],w=0;w<v.length;w++){var x=v[w];x==="."||x===""&&w!==0&&w!==v.length-1||(x===".."?p.pop():p.push(x))}return p.join("/")},t.getTypeOf=function(d){return typeof d=="string"?"string":Object.prototype.toString.call(d)==="[object Array]"?"array":n.nodebuffer&&r.isBuffer(d)?"nodebuffer":n.uint8array&&d instanceof Uint8Array?"uint8array":n.arraybuffer&&d instanceof ArrayBuffer?"arraybuffer":void 0},t.checkSupport=function(d){if(!n[d.toLowerCase()])throw new Error(d+" is not supported by this platform")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(d){var v,p,w="";for(p=0;p<(d||"").length;p++)w+="\\x"+((v=d.charCodeAt(p))<16?"0":"")+v.toString(16).toUpperCase();return w},t.delay=function(d,v,p){setImmediate(function(){d.apply(p||null,v||[])})},t.inherits=function(d,v){function p(){}p.prototype=v.prototype,d.prototype=new p},t.extend=function(){var d,v,p={};for(d=0;d<arguments.length;d++)for(v in arguments[d])Object.prototype.hasOwnProperty.call(arguments[d],v)&&p[v]===void 0&&(p[v]=arguments[d][v]);return p},t.prepareContent=function(d,v,p,w,x){return o.Promise.resolve(v).then(function(E){return n.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader!="undefined"?new o.Promise(function(C,B){var O=new FileReader;O.onload=function($){C($.target.result)},O.onerror=function($){B($.target.error)},O.readAsArrayBuffer(E)}):E}).then(function(E){var C=t.getTypeOf(E);return C?(C==="arraybuffer"?E=t.transformTo("uint8array",E):C==="string"&&(x?E=i.decode(E):p&&w!==!0&&(E=(function(B){return c(B,n.uint8array?new Uint8Array(B.length):new Array(B.length))})(E))),E):o.Promise.reject(new Error("Can't read the data of '"+d+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(s,e,t){"use strict";var n=s("./reader/readerFor"),i=s("./utils"),r=s("./signature"),o=s("./zipEntry"),l=s("./support");function c(h){this.files=[],this.loadOptions=h}c.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(g)+", expected "+i.pretty(h)+")")}},isSignature:function(h,g){var f=this.reader.index;this.reader.setIndex(h);var b=this.reader.readString(4)===g;return this.reader.setIndex(f),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),g=l.uint8array?"uint8array":"array",f=i.transformTo(g,h);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h,g,f,b=this.zip64EndOfCentralSize-44;0<b;)h=this.reader.readInt(2),g=this.reader.readInt(4),f=this.reader.readData(g),this.zip64ExtensibleData[h]={id:h,length:g,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,g;for(h=0;h<this.files.length;h++)g=this.files[h],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(r.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(r.CENTRAL_FILE_HEADER);)(h=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);if(h<0)throw this.isSignature(0,r.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(h);var g=h;if(this.checkSignature(r.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(h=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,r.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var b=g-f;if(0<b)this.isSignature(g,r.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(h){this.reader=n(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(s,e,t){"use strict";var n=s("./reader/readerFor"),i=s("./utils"),r=s("./compressedObject"),o=s("./crc32"),l=s("./utf8"),c=s("./compressions"),h=s("./support");function g(f,b){this.options=f,this.loadOptions=b}g.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var b,d;if(f.skip(22),this.fileNameLength=f.readInt(2),d=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(d),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((b=(function(v){for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)&&c[p].magic===v)return c[p];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new r(this.compressedSize,this.uncompressedSize,this.crc32,b,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var b=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(b),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var b,d,v,p=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<p;)b=f.readInt(2),d=f.readInt(2),v=f.readData(d),this.extraFields[b]={id:b,length:d,value:v};f.setIndex(p)},handleUTF8:function(){var f=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var d=i.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(d)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var p=i.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(p)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var b=n(f.value);return b.readInt(1)!==1||o(this.fileName)!==b.readInt(4)?null:l.utf8decode(b.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var b=n(f.value);return b.readInt(1)!==1||o(this.fileComment)!==b.readInt(4)?null:l.utf8decode(b.readData(f.length-5))}return null}},e.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(s,e,t){"use strict";function n(b,d,v){this.name=b,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=d,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var i=s("./stream/StreamHelper"),r=s("./stream/DataWorker"),o=s("./utf8"),l=s("./compressedObject"),c=s("./stream/GenericWorker");n.prototype={internalStream:function(b){var d=null,v="string";try{if(!b)throw new Error("No output type specified.");var p=(v=b.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),d=this._decompressWorker();var w=!this._dataBinary;w&&!p&&(d=d.pipe(new o.Utf8EncodeWorker)),!w&&p&&(d=d.pipe(new o.Utf8DecodeWorker))}catch(x){(d=new c("error")).error(x)}return new i(d,v,"")},async:function(b,d){return this.internalStream(b).accumulate(d)},nodeStream:function(b,d){return this.internalStream(b||"nodebuffer").toNodejsStream(d)},_compressWorker:function(b,d){if(this._data instanceof l&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new o.Utf8EncodeWorker)),l.createWorkerFrom(v,b,d)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof c?this._data:new r(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],g=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<h.length;f++)n.prototype[h[f]]=g;e.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(s,e,t){(function(n){"use strict";var i,r,o=n.MutationObserver||n.WebKitMutationObserver;if(o){var l=0,c=new o(b),h=n.document.createTextNode("");c.observe(h,{characterData:!0}),i=function(){h.data=l=++l%2}}else if(n.setImmediate||n.MessageChannel===void 0)i="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var d=n.document.createElement("script");d.onreadystatechange=function(){b(),d.onreadystatechange=null,d.parentNode.removeChild(d),d=null},n.document.documentElement.appendChild(d)}:function(){setTimeout(b,0)};else{var g=new n.MessageChannel;g.port1.onmessage=b,i=function(){g.port2.postMessage(0)}}var f=[];function b(){var d,v;r=!0;for(var p=f.length;p;){for(v=f,f=[],d=-1;++d<p;)v[d]();p=f.length}r=!1}e.exports=function(d){f.push(d)!==1||r||i()}}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(s,e,t){"use strict";var n=s("immediate");function i(){}var r={},o=["REJECTED"],l=["FULFILLED"],c=["PENDING"];function h(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,p!==i&&d(this,p)}function g(p,w,x){this.promise=p,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof x=="function"&&(this.onRejected=x,this.callRejected=this.otherCallRejected)}function f(p,w,x){n(function(){var E;try{E=w(x)}catch(C){return r.reject(p,C)}E===p?r.reject(p,new TypeError("Cannot resolve promise with itself")):r.resolve(p,E)})}function b(p){var w=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof w=="function")return function(){w.apply(p,arguments)}}function d(p,w){var x=!1;function E(O){x||(x=!0,r.reject(p,O))}function C(O){x||(x=!0,r.resolve(p,O))}var B=v(function(){w(C,E)});B.status==="error"&&E(B.value)}function v(p,w){var x={};try{x.value=p(w),x.status="success"}catch(E){x.status="error",x.value=E}return x}(e.exports=h).prototype.finally=function(p){if(typeof p!="function")return this;var w=this.constructor;return this.then(function(x){return w.resolve(p()).then(function(){return x})},function(x){return w.resolve(p()).then(function(){throw x})})},h.prototype.catch=function(p){return this.then(null,p)},h.prototype.then=function(p,w){if(typeof p!="function"&&this.state===l||typeof w!="function"&&this.state===o)return this;var x=new this.constructor(i);return this.state!==c?f(x,this.state===l?p:w,this.outcome):this.queue.push(new g(x,p,w)),x},g.prototype.callFulfilled=function(p){r.resolve(this.promise,p)},g.prototype.otherCallFulfilled=function(p){f(this.promise,this.onFulfilled,p)},g.prototype.callRejected=function(p){r.reject(this.promise,p)},g.prototype.otherCallRejected=function(p){f(this.promise,this.onRejected,p)},r.resolve=function(p,w){var x=v(b,w);if(x.status==="error")return r.reject(p,x.value);var E=x.value;if(E)d(p,E);else{p.state=l,p.outcome=w;for(var C=-1,B=p.queue.length;++C<B;)p.queue[C].callFulfilled(w)}return p},r.reject=function(p,w){p.state=o,p.outcome=w;for(var x=-1,E=p.queue.length;++x<E;)p.queue[x].callRejected(w);return p},h.resolve=function(p){return p instanceof this?p:r.resolve(new this(i),p)},h.reject=function(p){var w=new this(i);return r.reject(w,p)},h.all=function(p){var w=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=p.length,E=!1;if(!x)return this.resolve([]);for(var C=new Array(x),B=0,O=-1,$=new this(i);++O<x;)T(p[O],O);return $;function T(W,q){w.resolve(W).then(function(_){C[q]=_,++B!==x||E||(E=!0,r.resolve($,C))},function(_){E||(E=!0,r.reject($,_))})}},h.race=function(p){var w=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=p.length,E=!1;if(!x)return this.resolve([]);for(var C=-1,B=new this(i);++C<x;)O=p[C],w.resolve(O).then(function($){E||(E=!0,r.resolve(B,$))},function($){E||(E=!0,r.reject(B,$))});var O;return B}},{immediate:36}],38:[function(s,e,t){"use strict";var n={};(0,s("./lib/utils/common").assign)(n,s("./lib/deflate"),s("./lib/inflate"),s("./lib/zlib/constants")),e.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(s,e,t){"use strict";var n=s("./zlib/deflate"),i=s("./utils/common"),r=s("./utils/strings"),o=s("./zlib/messages"),l=s("./zlib/zstream"),c=Object.prototype.toString,h=0,g=-1,f=0,b=8;function d(p){if(!(this instanceof d))return new d(p);this.options=i.assign({level:g,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},p||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var x=n.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(x!==h)throw new Error(o[x]);if(w.header&&n.deflateSetHeader(this.strm,w.header),w.dictionary){var E;if(E=typeof w.dictionary=="string"?r.string2buf(w.dictionary):c.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(x=n.deflateSetDictionary(this.strm,E))!==h)throw new Error(o[x]);this._dict_set=!0}}function v(p,w){var x=new d(w);if(x.push(p,!0),x.err)throw x.msg||o[x.err];return x.result}d.prototype.push=function(p,w){var x,E,C=this.strm,B=this.options.chunkSize;if(this.ended)return!1;E=w===~~w?w:w===!0?4:0,typeof p=="string"?C.input=r.string2buf(p):c.call(p)==="[object ArrayBuffer]"?C.input=new Uint8Array(p):C.input=p,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new i.Buf8(B),C.next_out=0,C.avail_out=B),(x=n.deflate(C,E))!==1&&x!==h)return this.onEnd(x),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||E!==4&&E!==2)||(this.options.to==="string"?this.onData(r.buf2binstring(i.shrinkBuf(C.output,C.next_out))):this.onData(i.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&x!==1);return E===4?(x=n.deflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===h):E!==2||(this.onEnd(h),!(C.avail_out=0))},d.prototype.onData=function(p){this.chunks.push(p)},d.prototype.onEnd=function(p){p===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},t.Deflate=d,t.deflate=v,t.deflateRaw=function(p,w){return(w=w||{}).raw=!0,v(p,w)},t.gzip=function(p,w){return(w=w||{}).gzip=!0,v(p,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(s,e,t){"use strict";var n=s("./zlib/inflate"),i=s("./utils/common"),r=s("./utils/strings"),o=s("./zlib/constants"),l=s("./zlib/messages"),c=s("./zlib/zstream"),h=s("./zlib/gzheader"),g=Object.prototype.toString;function f(d){if(!(this instanceof f))return new f(d);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},d||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||d&&d.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var p=n.inflateInit2(this.strm,v.windowBits);if(p!==o.Z_OK)throw new Error(l[p]);this.header=new h,n.inflateGetHeader(this.strm,this.header)}function b(d,v){var p=new f(v);if(p.push(d,!0),p.err)throw p.msg||l[p.err];return p.result}f.prototype.push=function(d,v){var p,w,x,E,C,B,O=this.strm,$=this.options.chunkSize,T=this.options.dictionary,W=!1;if(this.ended)return!1;w=v===~~v?v:v===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof d=="string"?O.input=r.binstring2buf(d):g.call(d)==="[object ArrayBuffer]"?O.input=new Uint8Array(d):O.input=d,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new i.Buf8($),O.next_out=0,O.avail_out=$),(p=n.inflate(O,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&T&&(B=typeof T=="string"?r.string2buf(T):g.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,p=n.inflateSetDictionary(this.strm,B)),p===o.Z_BUF_ERROR&&W===!0&&(p=o.Z_OK,W=!1),p!==o.Z_STREAM_END&&p!==o.Z_OK)return this.onEnd(p),!(this.ended=!0);O.next_out&&(O.avail_out!==0&&p!==o.Z_STREAM_END&&(O.avail_in!==0||w!==o.Z_FINISH&&w!==o.Z_SYNC_FLUSH)||(this.options.to==="string"?(x=r.utf8border(O.output,O.next_out),E=O.next_out-x,C=r.buf2string(O.output,x),O.next_out=E,O.avail_out=$-E,E&&i.arraySet(O.output,O.output,x,E,0),this.onData(C)):this.onData(i.shrinkBuf(O.output,O.next_out)))),O.avail_in===0&&O.avail_out===0&&(W=!0)}while((0<O.avail_in||O.avail_out===0)&&p!==o.Z_STREAM_END);return p===o.Z_STREAM_END&&(w=o.Z_FINISH),w===o.Z_FINISH?(p=n.inflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===o.Z_OK):w!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(O.avail_out=0))},f.prototype.onData=function(d){this.chunks.push(d)},f.prototype.onEnd=function(d){d===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},t.Inflate=f,t.inflate=b,t.inflateRaw=function(d,v){return(v=v||{}).raw=!0,b(d,v)},t.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(s,e,t){"use strict";var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";t.assign=function(o){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var c=l.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var h in c)c.hasOwnProperty(h)&&(o[h]=c[h])}}return o},t.shrinkBuf=function(o,l){return o.length===l?o:o.subarray?o.subarray(0,l):(o.length=l,o)};var i={arraySet:function(o,l,c,h,g){if(l.subarray&&o.subarray)o.set(l.subarray(c,c+h),g);else for(var f=0;f<h;f++)o[g+f]=l[c+f]},flattenChunks:function(o){var l,c,h,g,f,b;for(l=h=0,c=o.length;l<c;l++)h+=o[l].length;for(b=new Uint8Array(h),l=g=0,c=o.length;l<c;l++)f=o[l],b.set(f,g),g+=f.length;return b}},r={arraySet:function(o,l,c,h,g){for(var f=0;f<h;f++)o[g+f]=l[c+f]},flattenChunks:function(o){return[].concat.apply([],o)}};t.setTyped=function(o){o?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,r))},t.setTyped(n)},{}],42:[function(s,e,t){"use strict";var n=s("./common"),i=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch(h){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(h){r=!1}for(var o=new n.Buf8(256),l=0;l<256;l++)o[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(h,g){if(g<65537&&(h.subarray&&r||!h.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(h,g));for(var f="",b=0;b<g;b++)f+=String.fromCharCode(h[b]);return f}o[254]=o[254]=1,t.string2buf=function(h){var g,f,b,d,v,p=h.length,w=0;for(d=0;d<p;d++)(64512&(f=h.charCodeAt(d)))==55296&&d+1<p&&(64512&(b=h.charCodeAt(d+1)))==56320&&(f=65536+(f-55296<<10)+(b-56320),d++),w+=f<128?1:f<2048?2:f<65536?3:4;for(g=new n.Buf8(w),d=v=0;v<w;d++)(64512&(f=h.charCodeAt(d)))==55296&&d+1<p&&(64512&(b=h.charCodeAt(d+1)))==56320&&(f=65536+(f-55296<<10)+(b-56320),d++),f<128?g[v++]=f:(f<2048?g[v++]=192|f>>>6:(f<65536?g[v++]=224|f>>>12:(g[v++]=240|f>>>18,g[v++]=128|f>>>12&63),g[v++]=128|f>>>6&63),g[v++]=128|63&f);return g},t.buf2binstring=function(h){return c(h,h.length)},t.binstring2buf=function(h){for(var g=new n.Buf8(h.length),f=0,b=g.length;f<b;f++)g[f]=h.charCodeAt(f);return g},t.buf2string=function(h,g){var f,b,d,v,p=g||h.length,w=new Array(2*p);for(f=b=0;f<p;)if((d=h[f++])<128)w[b++]=d;else if(4<(v=o[d]))w[b++]=65533,f+=v-1;else{for(d&=v===2?31:v===3?15:7;1<v&&f<p;)d=d<<6|63&h[f++],v--;1<v?w[b++]=65533:d<65536?w[b++]=d:(d-=65536,w[b++]=55296|d>>10&1023,w[b++]=56320|1023&d)}return c(w,b)},t.utf8border=function(h,g){var f;for((g=g||h.length)>h.length&&(g=h.length),f=g-1;0<=f&&(192&h[f])==128;)f--;return f<0||f===0?g:f+o[h[f]]>g?f:g}},{"./common":41}],43:[function(s,e,t){"use strict";e.exports=function(n,i,r,o){for(var l=65535&n|0,c=n>>>16&65535|0,h=0;r!==0;){for(r-=h=2e3<r?2e3:r;c=c+(l=l+i[o++]|0)|0,--h;);l%=65521,c%=65521}return l|c<<16|0}},{}],44:[function(s,e,t){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(s,e,t){"use strict";var n=(function(){for(var i,r=[],o=0;o<256;o++){i=o;for(var l=0;l<8;l++)i=1&i?3988292384^i>>>1:i>>>1;r[o]=i}return r})();e.exports=function(i,r,o,l){var c=n,h=l+o;i^=-1;for(var g=l;g<h;g++)i=i>>>8^c[255&(i^r[g])];return-1^i}},{}],46:[function(s,e,t){"use strict";var n,i=s("../utils/common"),r=s("./trees"),o=s("./adler32"),l=s("./crc32"),c=s("./messages"),h=0,g=4,f=0,b=-2,d=-1,v=4,p=2,w=8,x=9,E=286,C=30,B=19,O=2*E+1,$=15,T=3,W=258,q=W+T+1,_=42,P=113,u=1,F=2,K=3,M=4;function J(a,z){return a.msg=c[z],z}function U(a){return(a<<1)-(4<a?9:0)}function Y(a){for(var z=a.length;0<=--z;)a[z]=0}function S(a){var z=a.state,A=z.pending;A>a.avail_out&&(A=a.avail_out),A!==0&&(i.arraySet(a.output,z.pending_buf,z.pending_out,A,a.next_out),a.next_out+=A,z.pending_out+=A,a.total_out+=A,a.avail_out-=A,z.pending-=A,z.pending===0&&(z.pending_out=0))}function N(a,z){r._tr_flush_block(a,0<=a.block_start?a.block_start:-1,a.strstart-a.block_start,z),a.block_start=a.strstart,S(a.strm)}function G(a,z){a.pending_buf[a.pending++]=z}function V(a,z){a.pending_buf[a.pending++]=z>>>8&255,a.pending_buf[a.pending++]=255&z}function Z(a,z){var A,y,m=a.max_chain_length,k=a.strstart,R=a.prev_length,L=a.nice_match,I=a.strstart>a.w_size-q?a.strstart-(a.w_size-q):0,j=a.window,X=a.w_mask,D=a.prev,H=a.strstart+W,rt=j[k+R-1],tt=j[k+R];a.prev_length>=a.good_match&&(m>>=2),L>a.lookahead&&(L=a.lookahead);do if(j[(A=z)+R]===tt&&j[A+R-1]===rt&&j[A]===j[k]&&j[++A]===j[k+1]){k+=2,A++;do;while(j[++k]===j[++A]&&j[++k]===j[++A]&&j[++k]===j[++A]&&j[++k]===j[++A]&&j[++k]===j[++A]&&j[++k]===j[++A]&&j[++k]===j[++A]&&j[++k]===j[++A]&&k<H);if(y=W-(H-k),k=H-W,R<y){if(a.match_start=z,L<=(R=y))break;rt=j[k+R-1],tt=j[k+R]}}while((z=D[z&X])>I&&--m!=0);return R<=a.lookahead?R:a.lookahead}function nt(a){var z,A,y,m,k,R,L,I,j,X,D=a.w_size;do{if(m=a.window_size-a.lookahead-a.strstart,a.strstart>=D+(D-q)){for(i.arraySet(a.window,a.window,D,D,0),a.match_start-=D,a.strstart-=D,a.block_start-=D,z=A=a.hash_size;y=a.head[--z],a.head[z]=D<=y?y-D:0,--A;);for(z=A=D;y=a.prev[--z],a.prev[z]=D<=y?y-D:0,--A;);m+=D}if(a.strm.avail_in===0)break;if(R=a.strm,L=a.window,I=a.strstart+a.lookahead,j=m,X=void 0,X=R.avail_in,j<X&&(X=j),A=X===0?0:(R.avail_in-=X,i.arraySet(L,R.input,R.next_in,X,I),R.state.wrap===1?R.adler=o(R.adler,L,X,I):R.state.wrap===2&&(R.adler=l(R.adler,L,X,I)),R.next_in+=X,R.total_in+=X,X),a.lookahead+=A,a.lookahead+a.insert>=T)for(k=a.strstart-a.insert,a.ins_h=a.window[k],a.ins_h=(a.ins_h<<a.hash_shift^a.window[k+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[k+T-1])&a.hash_mask,a.prev[k&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=k,k++,a.insert--,!(a.lookahead+a.insert<T)););}while(a.lookahead<q&&a.strm.avail_in!==0)}function lt(a,z){for(var A,y;;){if(a.lookahead<q){if(nt(a),a.lookahead<q&&z===h)return u;if(a.lookahead===0)break}if(A=0,a.lookahead>=T&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+T-1])&a.hash_mask,A=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),A!==0&&a.strstart-A<=a.w_size-q&&(a.match_length=Z(a,A)),a.match_length>=T)if(y=r._tr_tally(a,a.strstart-a.match_start,a.match_length-T),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=T){for(a.match_length--;a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+T-1])&a.hash_mask,A=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart,--a.match_length!=0;);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else y=r._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(y&&(N(a,!1),a.strm.avail_out===0))return u}return a.insert=a.strstart<T-1?a.strstart:T-1,z===g?(N(a,!0),a.strm.avail_out===0?K:M):a.last_lit&&(N(a,!1),a.strm.avail_out===0)?u:F}function Q(a,z){for(var A,y,m;;){if(a.lookahead<q){if(nt(a),a.lookahead<q&&z===h)return u;if(a.lookahead===0)break}if(A=0,a.lookahead>=T&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+T-1])&a.hash_mask,A=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=T-1,A!==0&&a.prev_length<a.max_lazy_match&&a.strstart-A<=a.w_size-q&&(a.match_length=Z(a,A),a.match_length<=5&&(a.strategy===1||a.match_length===T&&4096<a.strstart-a.match_start)&&(a.match_length=T-1)),a.prev_length>=T&&a.match_length<=a.prev_length){for(m=a.strstart+a.lookahead-T,y=r._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-T),a.lookahead-=a.prev_length-1,a.prev_length-=2;++a.strstart<=m&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+T-1])&a.hash_mask,A=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),--a.prev_length!=0;);if(a.match_available=0,a.match_length=T-1,a.strstart++,y&&(N(a,!1),a.strm.avail_out===0))return u}else if(a.match_available){if((y=r._tr_tally(a,0,a.window[a.strstart-1]))&&N(a,!1),a.strstart++,a.lookahead--,a.strm.avail_out===0)return u}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(y=r._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<T-1?a.strstart:T-1,z===g?(N(a,!0),a.strm.avail_out===0?K:M):a.last_lit&&(N(a,!1),a.strm.avail_out===0)?u:F}function et(a,z,A,y,m){this.good_length=a,this.max_lazy=z,this.nice_length=A,this.max_chain=y,this.func=m}function at(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*O),this.dyn_dtree=new i.Buf16(2*(2*C+1)),this.bl_tree=new i.Buf16(2*(2*B+1)),Y(this.dyn_ltree),Y(this.dyn_dtree),Y(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16($+1),this.heap=new i.Buf16(2*E+1),Y(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*E+1),Y(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function it(a){var z;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=p,(z=a.state).pending=0,z.pending_out=0,z.wrap<0&&(z.wrap=-z.wrap),z.status=z.wrap?_:P,a.adler=z.wrap===2?0:1,z.last_flush=h,r._tr_init(z),f):J(a,b)}function gt(a){var z=it(a);return z===f&&(function(A){A.window_size=2*A.w_size,Y(A.head),A.max_lazy_match=n[A.level].max_lazy,A.good_match=n[A.level].good_length,A.nice_match=n[A.level].nice_length,A.max_chain_length=n[A.level].max_chain,A.strstart=0,A.block_start=0,A.lookahead=0,A.insert=0,A.match_length=A.prev_length=T-1,A.match_available=0,A.ins_h=0})(a.state),z}function pt(a,z,A,y,m,k){if(!a)return b;var R=1;if(z===d&&(z=6),y<0?(R=0,y=-y):15<y&&(R=2,y-=16),m<1||x<m||A!==w||y<8||15<y||z<0||9<z||k<0||v<k)return J(a,b);y===8&&(y=9);var L=new at;return(a.state=L).strm=a,L.wrap=R,L.gzhead=null,L.w_bits=y,L.w_size=1<<L.w_bits,L.w_mask=L.w_size-1,L.hash_bits=m+7,L.hash_size=1<<L.hash_bits,L.hash_mask=L.hash_size-1,L.hash_shift=~~((L.hash_bits+T-1)/T),L.window=new i.Buf8(2*L.w_size),L.head=new i.Buf16(L.hash_size),L.prev=new i.Buf16(L.w_size),L.lit_bufsize=1<<m+6,L.pending_buf_size=4*L.lit_bufsize,L.pending_buf=new i.Buf8(L.pending_buf_size),L.d_buf=1*L.lit_bufsize,L.l_buf=3*L.lit_bufsize,L.level=z,L.strategy=k,L.method=A,gt(a)}n=[new et(0,0,0,0,function(a,z){var A=65535;for(A>a.pending_buf_size-5&&(A=a.pending_buf_size-5);;){if(a.lookahead<=1){if(nt(a),a.lookahead===0&&z===h)return u;if(a.lookahead===0)break}a.strstart+=a.lookahead,a.lookahead=0;var y=a.block_start+A;if((a.strstart===0||a.strstart>=y)&&(a.lookahead=a.strstart-y,a.strstart=y,N(a,!1),a.strm.avail_out===0)||a.strstart-a.block_start>=a.w_size-q&&(N(a,!1),a.strm.avail_out===0))return u}return a.insert=0,z===g?(N(a,!0),a.strm.avail_out===0?K:M):(a.strstart>a.block_start&&(N(a,!1),a.strm.avail_out),u)}),new et(4,4,8,4,lt),new et(4,5,16,8,lt),new et(4,6,32,32,lt),new et(4,4,16,16,Q),new et(8,16,32,32,Q),new et(8,16,128,128,Q),new et(8,32,128,256,Q),new et(32,128,258,1024,Q),new et(32,258,258,4096,Q)],t.deflateInit=function(a,z){return pt(a,z,w,15,8,0)},t.deflateInit2=pt,t.deflateReset=gt,t.deflateResetKeep=it,t.deflateSetHeader=function(a,z){return a&&a.state?a.state.wrap!==2?b:(a.state.gzhead=z,f):b},t.deflate=function(a,z){var A,y,m,k;if(!a||!a.state||5<z||z<0)return a?J(a,b):b;if(y=a.state,!a.output||!a.input&&a.avail_in!==0||y.status===666&&z!==g)return J(a,a.avail_out===0?-5:b);if(y.strm=a,A=y.last_flush,y.last_flush=z,y.status===_)if(y.wrap===2)a.adler=0,G(y,31),G(y,139),G(y,8),y.gzhead?(G(y,(y.gzhead.text?1:0)+(y.gzhead.hcrc?2:0)+(y.gzhead.extra?4:0)+(y.gzhead.name?8:0)+(y.gzhead.comment?16:0)),G(y,255&y.gzhead.time),G(y,y.gzhead.time>>8&255),G(y,y.gzhead.time>>16&255),G(y,y.gzhead.time>>24&255),G(y,y.level===9?2:2<=y.strategy||y.level<2?4:0),G(y,255&y.gzhead.os),y.gzhead.extra&&y.gzhead.extra.length&&(G(y,255&y.gzhead.extra.length),G(y,y.gzhead.extra.length>>8&255)),y.gzhead.hcrc&&(a.adler=l(a.adler,y.pending_buf,y.pending,0)),y.gzindex=0,y.status=69):(G(y,0),G(y,0),G(y,0),G(y,0),G(y,0),G(y,y.level===9?2:2<=y.strategy||y.level<2?4:0),G(y,3),y.status=P);else{var R=w+(y.w_bits-8<<4)<<8;R|=(2<=y.strategy||y.level<2?0:y.level<6?1:y.level===6?2:3)<<6,y.strstart!==0&&(R|=32),R+=31-R%31,y.status=P,V(y,R),y.strstart!==0&&(V(y,a.adler>>>16),V(y,65535&a.adler)),a.adler=1}if(y.status===69)if(y.gzhead.extra){for(m=y.pending;y.gzindex<(65535&y.gzhead.extra.length)&&(y.pending!==y.pending_buf_size||(y.gzhead.hcrc&&y.pending>m&&(a.adler=l(a.adler,y.pending_buf,y.pending-m,m)),S(a),m=y.pending,y.pending!==y.pending_buf_size));)G(y,255&y.gzhead.extra[y.gzindex]),y.gzindex++;y.gzhead.hcrc&&y.pending>m&&(a.adler=l(a.adler,y.pending_buf,y.pending-m,m)),y.gzindex===y.gzhead.extra.length&&(y.gzindex=0,y.status=73)}else y.status=73;if(y.status===73)if(y.gzhead.name){m=y.pending;do{if(y.pending===y.pending_buf_size&&(y.gzhead.hcrc&&y.pending>m&&(a.adler=l(a.adler,y.pending_buf,y.pending-m,m)),S(a),m=y.pending,y.pending===y.pending_buf_size)){k=1;break}k=y.gzindex<y.gzhead.name.length?255&y.gzhead.name.charCodeAt(y.gzindex++):0,G(y,k)}while(k!==0);y.gzhead.hcrc&&y.pending>m&&(a.adler=l(a.adler,y.pending_buf,y.pending-m,m)),k===0&&(y.gzindex=0,y.status=91)}else y.status=91;if(y.status===91)if(y.gzhead.comment){m=y.pending;do{if(y.pending===y.pending_buf_size&&(y.gzhead.hcrc&&y.pending>m&&(a.adler=l(a.adler,y.pending_buf,y.pending-m,m)),S(a),m=y.pending,y.pending===y.pending_buf_size)){k=1;break}k=y.gzindex<y.gzhead.comment.length?255&y.gzhead.comment.charCodeAt(y.gzindex++):0,G(y,k)}while(k!==0);y.gzhead.hcrc&&y.pending>m&&(a.adler=l(a.adler,y.pending_buf,y.pending-m,m)),k===0&&(y.status=103)}else y.status=103;if(y.status===103&&(y.gzhead.hcrc?(y.pending+2>y.pending_buf_size&&S(a),y.pending+2<=y.pending_buf_size&&(G(y,255&a.adler),G(y,a.adler>>8&255),a.adler=0,y.status=P)):y.status=P),y.pending!==0){if(S(a),a.avail_out===0)return y.last_flush=-1,f}else if(a.avail_in===0&&U(z)<=U(A)&&z!==g)return J(a,-5);if(y.status===666&&a.avail_in!==0)return J(a,-5);if(a.avail_in!==0||y.lookahead!==0||z!==h&&y.status!==666){var L=y.strategy===2?(function(I,j){for(var X;;){if(I.lookahead===0&&(nt(I),I.lookahead===0)){if(j===h)return u;break}if(I.match_length=0,X=r._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++,X&&(N(I,!1),I.strm.avail_out===0))return u}return I.insert=0,j===g?(N(I,!0),I.strm.avail_out===0?K:M):I.last_lit&&(N(I,!1),I.strm.avail_out===0)?u:F})(y,z):y.strategy===3?(function(I,j){for(var X,D,H,rt,tt=I.window;;){if(I.lookahead<=W){if(nt(I),I.lookahead<=W&&j===h)return u;if(I.lookahead===0)break}if(I.match_length=0,I.lookahead>=T&&0<I.strstart&&(D=tt[H=I.strstart-1])===tt[++H]&&D===tt[++H]&&D===tt[++H]){rt=I.strstart+W;do;while(D===tt[++H]&&D===tt[++H]&&D===tt[++H]&&D===tt[++H]&&D===tt[++H]&&D===tt[++H]&&D===tt[++H]&&D===tt[++H]&&H<rt);I.match_length=W-(rt-H),I.match_length>I.lookahead&&(I.match_length=I.lookahead)}if(I.match_length>=T?(X=r._tr_tally(I,1,I.match_length-T),I.lookahead-=I.match_length,I.strstart+=I.match_length,I.match_length=0):(X=r._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++),X&&(N(I,!1),I.strm.avail_out===0))return u}return I.insert=0,j===g?(N(I,!0),I.strm.avail_out===0?K:M):I.last_lit&&(N(I,!1),I.strm.avail_out===0)?u:F})(y,z):n[y.level].func(y,z);if(L!==K&&L!==M||(y.status=666),L===u||L===K)return a.avail_out===0&&(y.last_flush=-1),f;if(L===F&&(z===1?r._tr_align(y):z!==5&&(r._tr_stored_block(y,0,0,!1),z===3&&(Y(y.head),y.lookahead===0&&(y.strstart=0,y.block_start=0,y.insert=0))),S(a),a.avail_out===0))return y.last_flush=-1,f}return z!==g?f:y.wrap<=0?1:(y.wrap===2?(G(y,255&a.adler),G(y,a.adler>>8&255),G(y,a.adler>>16&255),G(y,a.adler>>24&255),G(y,255&a.total_in),G(y,a.total_in>>8&255),G(y,a.total_in>>16&255),G(y,a.total_in>>24&255)):(V(y,a.adler>>>16),V(y,65535&a.adler)),S(a),0<y.wrap&&(y.wrap=-y.wrap),y.pending!==0?f:1)},t.deflateEnd=function(a){var z;return a&&a.state?(z=a.state.status)!==_&&z!==69&&z!==73&&z!==91&&z!==103&&z!==P&&z!==666?J(a,b):(a.state=null,z===P?J(a,-3):f):b},t.deflateSetDictionary=function(a,z){var A,y,m,k,R,L,I,j,X=z.length;if(!a||!a.state||(k=(A=a.state).wrap)===2||k===1&&A.status!==_||A.lookahead)return b;for(k===1&&(a.adler=o(a.adler,z,X,0)),A.wrap=0,X>=A.w_size&&(k===0&&(Y(A.head),A.strstart=0,A.block_start=0,A.insert=0),j=new i.Buf8(A.w_size),i.arraySet(j,z,X-A.w_size,A.w_size,0),z=j,X=A.w_size),R=a.avail_in,L=a.next_in,I=a.input,a.avail_in=X,a.next_in=0,a.input=z,nt(A);A.lookahead>=T;){for(y=A.strstart,m=A.lookahead-(T-1);A.ins_h=(A.ins_h<<A.hash_shift^A.window[y+T-1])&A.hash_mask,A.prev[y&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=y,y++,--m;);A.strstart=y,A.lookahead=T-1,nt(A)}return A.strstart+=A.lookahead,A.block_start=A.strstart,A.insert=A.lookahead,A.lookahead=0,A.match_length=A.prev_length=T-1,A.match_available=0,a.next_in=L,a.input=I,a.avail_in=R,A.wrap=k,f},t.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(s,e,t){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(s,e,t){"use strict";e.exports=function(n,i){var r,o,l,c,h,g,f,b,d,v,p,w,x,E,C,B,O,$,T,W,q,_,P,u,F;r=n.state,o=n.next_in,u=n.input,l=o+(n.avail_in-5),c=n.next_out,F=n.output,h=c-(i-n.avail_out),g=c+(n.avail_out-257),f=r.dmax,b=r.wsize,d=r.whave,v=r.wnext,p=r.window,w=r.hold,x=r.bits,E=r.lencode,C=r.distcode,B=(1<<r.lenbits)-1,O=(1<<r.distbits)-1;t:do{x<15&&(w+=u[o++]<<x,x+=8,w+=u[o++]<<x,x+=8),$=E[w&B];e:for(;;){if(w>>>=T=$>>>24,x-=T,(T=$>>>16&255)===0)F[c++]=65535&$;else{if(!(16&T)){if((64&T)==0){$=E[(65535&$)+(w&(1<<T)-1)];continue e}if(32&T){r.mode=12;break t}n.msg="invalid literal/length code",r.mode=30;break t}W=65535&$,(T&=15)&&(x<T&&(w+=u[o++]<<x,x+=8),W+=w&(1<<T)-1,w>>>=T,x-=T),x<15&&(w+=u[o++]<<x,x+=8,w+=u[o++]<<x,x+=8),$=C[w&O];r:for(;;){if(w>>>=T=$>>>24,x-=T,!(16&(T=$>>>16&255))){if((64&T)==0){$=C[(65535&$)+(w&(1<<T)-1)];continue r}n.msg="invalid distance code",r.mode=30;break t}if(q=65535&$,x<(T&=15)&&(w+=u[o++]<<x,(x+=8)<T&&(w+=u[o++]<<x,x+=8)),f<(q+=w&(1<<T)-1)){n.msg="invalid distance too far back",r.mode=30;break t}if(w>>>=T,x-=T,(T=c-h)<q){if(d<(T=q-T)&&r.sane){n.msg="invalid distance too far back",r.mode=30;break t}if(P=p,(_=0)===v){if(_+=b-T,T<W){for(W-=T;F[c++]=p[_++],--T;);_=c-q,P=F}}else if(v<T){if(_+=b+v-T,(T-=v)<W){for(W-=T;F[c++]=p[_++],--T;);if(_=0,v<W){for(W-=T=v;F[c++]=p[_++],--T;);_=c-q,P=F}}}else if(_+=v-T,T<W){for(W-=T;F[c++]=p[_++],--T;);_=c-q,P=F}for(;2<W;)F[c++]=P[_++],F[c++]=P[_++],F[c++]=P[_++],W-=3;W&&(F[c++]=P[_++],1<W&&(F[c++]=P[_++]))}else{for(_=c-q;F[c++]=F[_++],F[c++]=F[_++],F[c++]=F[_++],2<(W-=3););W&&(F[c++]=F[_++],1<W&&(F[c++]=F[_++]))}break}}break}}while(o<l&&c<g);o-=W=x>>3,w&=(1<<(x-=W<<3))-1,n.next_in=o,n.next_out=c,n.avail_in=o<l?l-o+5:5-(o-l),n.avail_out=c<g?g-c+257:257-(c-g),r.hold=w,r.bits=x}},{}],49:[function(s,e,t){"use strict";var n=s("../utils/common"),i=s("./adler32"),r=s("./crc32"),o=s("./inffast"),l=s("./inftrees"),c=1,h=2,g=0,f=-2,b=1,d=852,v=592;function p(_){return(_>>>24&255)+(_>>>8&65280)+((65280&_)<<8)+((255&_)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function x(_){var P;return _&&_.state?(P=_.state,_.total_in=_.total_out=P.total=0,_.msg="",P.wrap&&(_.adler=1&P.wrap),P.mode=b,P.last=0,P.havedict=0,P.dmax=32768,P.head=null,P.hold=0,P.bits=0,P.lencode=P.lendyn=new n.Buf32(d),P.distcode=P.distdyn=new n.Buf32(v),P.sane=1,P.back=-1,g):f}function E(_){var P;return _&&_.state?((P=_.state).wsize=0,P.whave=0,P.wnext=0,x(_)):f}function C(_,P){var u,F;return _&&_.state?(F=_.state,P<0?(u=0,P=-P):(u=1+(P>>4),P<48&&(P&=15)),P&&(P<8||15<P)?f:(F.window!==null&&F.wbits!==P&&(F.window=null),F.wrap=u,F.wbits=P,E(_))):f}function B(_,P){var u,F;return _?(F=new w,(_.state=F).window=null,(u=C(_,P))!==g&&(_.state=null),u):f}var O,$,T=!0;function W(_){if(T){var P;for(O=new n.Buf32(512),$=new n.Buf32(32),P=0;P<144;)_.lens[P++]=8;for(;P<256;)_.lens[P++]=9;for(;P<280;)_.lens[P++]=7;for(;P<288;)_.lens[P++]=8;for(l(c,_.lens,0,288,O,0,_.work,{bits:9}),P=0;P<32;)_.lens[P++]=5;l(h,_.lens,0,32,$,0,_.work,{bits:5}),T=!1}_.lencode=O,_.lenbits=9,_.distcode=$,_.distbits=5}function q(_,P,u,F){var K,M=_.state;return M.window===null&&(M.wsize=1<<M.wbits,M.wnext=0,M.whave=0,M.window=new n.Buf8(M.wsize)),F>=M.wsize?(n.arraySet(M.window,P,u-M.wsize,M.wsize,0),M.wnext=0,M.whave=M.wsize):(F<(K=M.wsize-M.wnext)&&(K=F),n.arraySet(M.window,P,u-F,K,M.wnext),(F-=K)?(n.arraySet(M.window,P,u-F,F,0),M.wnext=F,M.whave=M.wsize):(M.wnext+=K,M.wnext===M.wsize&&(M.wnext=0),M.whave<M.wsize&&(M.whave+=K))),0}t.inflateReset=E,t.inflateReset2=C,t.inflateResetKeep=x,t.inflateInit=function(_){return B(_,15)},t.inflateInit2=B,t.inflate=function(_,P){var u,F,K,M,J,U,Y,S,N,G,V,Z,nt,lt,Q,et,at,it,gt,pt,a,z,A,y,m=0,k=new n.Buf8(4),R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!_||!_.state||!_.output||!_.input&&_.avail_in!==0)return f;(u=_.state).mode===12&&(u.mode=13),J=_.next_out,K=_.output,Y=_.avail_out,M=_.next_in,F=_.input,U=_.avail_in,S=u.hold,N=u.bits,G=U,V=Y,z=g;t:for(;;)switch(u.mode){case b:if(u.wrap===0){u.mode=13;break}for(;N<16;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}if(2&u.wrap&&S===35615){k[u.check=0]=255&S,k[1]=S>>>8&255,u.check=r(u.check,k,2,0),N=S=0,u.mode=2;break}if(u.flags=0,u.head&&(u.head.done=!1),!(1&u.wrap)||(((255&S)<<8)+(S>>8))%31){_.msg="incorrect header check",u.mode=30;break}if((15&S)!=8){_.msg="unknown compression method",u.mode=30;break}if(N-=4,a=8+(15&(S>>>=4)),u.wbits===0)u.wbits=a;else if(a>u.wbits){_.msg="invalid window size",u.mode=30;break}u.dmax=1<<a,_.adler=u.check=1,u.mode=512&S?10:12,N=S=0;break;case 2:for(;N<16;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}if(u.flags=S,(255&u.flags)!=8){_.msg="unknown compression method",u.mode=30;break}if(57344&u.flags){_.msg="unknown header flags set",u.mode=30;break}u.head&&(u.head.text=S>>8&1),512&u.flags&&(k[0]=255&S,k[1]=S>>>8&255,u.check=r(u.check,k,2,0)),N=S=0,u.mode=3;case 3:for(;N<32;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}u.head&&(u.head.time=S),512&u.flags&&(k[0]=255&S,k[1]=S>>>8&255,k[2]=S>>>16&255,k[3]=S>>>24&255,u.check=r(u.check,k,4,0)),N=S=0,u.mode=4;case 4:for(;N<16;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}u.head&&(u.head.xflags=255&S,u.head.os=S>>8),512&u.flags&&(k[0]=255&S,k[1]=S>>>8&255,u.check=r(u.check,k,2,0)),N=S=0,u.mode=5;case 5:if(1024&u.flags){for(;N<16;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}u.length=S,u.head&&(u.head.extra_len=S),512&u.flags&&(k[0]=255&S,k[1]=S>>>8&255,u.check=r(u.check,k,2,0)),N=S=0}else u.head&&(u.head.extra=null);u.mode=6;case 6:if(1024&u.flags&&(U<(Z=u.length)&&(Z=U),Z&&(u.head&&(a=u.head.extra_len-u.length,u.head.extra||(u.head.extra=new Array(u.head.extra_len)),n.arraySet(u.head.extra,F,M,Z,a)),512&u.flags&&(u.check=r(u.check,F,Z,M)),U-=Z,M+=Z,u.length-=Z),u.length))break t;u.length=0,u.mode=7;case 7:if(2048&u.flags){if(U===0)break t;for(Z=0;a=F[M+Z++],u.head&&a&&u.length<65536&&(u.head.name+=String.fromCharCode(a)),a&&Z<U;);if(512&u.flags&&(u.check=r(u.check,F,Z,M)),U-=Z,M+=Z,a)break t}else u.head&&(u.head.name=null);u.length=0,u.mode=8;case 8:if(4096&u.flags){if(U===0)break t;for(Z=0;a=F[M+Z++],u.head&&a&&u.length<65536&&(u.head.comment+=String.fromCharCode(a)),a&&Z<U;);if(512&u.flags&&(u.check=r(u.check,F,Z,M)),U-=Z,M+=Z,a)break t}else u.head&&(u.head.comment=null);u.mode=9;case 9:if(512&u.flags){for(;N<16;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}if(S!==(65535&u.check)){_.msg="header crc mismatch",u.mode=30;break}N=S=0}u.head&&(u.head.hcrc=u.flags>>9&1,u.head.done=!0),_.adler=u.check=0,u.mode=12;break;case 10:for(;N<32;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}_.adler=u.check=p(S),N=S=0,u.mode=11;case 11:if(u.havedict===0)return _.next_out=J,_.avail_out=Y,_.next_in=M,_.avail_in=U,u.hold=S,u.bits=N,2;_.adler=u.check=1,u.mode=12;case 12:if(P===5||P===6)break t;case 13:if(u.last){S>>>=7&N,N-=7&N,u.mode=27;break}for(;N<3;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}switch(u.last=1&S,N-=1,3&(S>>>=1)){case 0:u.mode=14;break;case 1:if(W(u),u.mode=20,P!==6)break;S>>>=2,N-=2;break t;case 2:u.mode=17;break;case 3:_.msg="invalid block type",u.mode=30}S>>>=2,N-=2;break;case 14:for(S>>>=7&N,N-=7&N;N<32;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}if((65535&S)!=(S>>>16^65535)){_.msg="invalid stored block lengths",u.mode=30;break}if(u.length=65535&S,N=S=0,u.mode=15,P===6)break t;case 15:u.mode=16;case 16:if(Z=u.length){if(U<Z&&(Z=U),Y<Z&&(Z=Y),Z===0)break t;n.arraySet(K,F,M,Z,J),U-=Z,M+=Z,Y-=Z,J+=Z,u.length-=Z;break}u.mode=12;break;case 17:for(;N<14;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}if(u.nlen=257+(31&S),S>>>=5,N-=5,u.ndist=1+(31&S),S>>>=5,N-=5,u.ncode=4+(15&S),S>>>=4,N-=4,286<u.nlen||30<u.ndist){_.msg="too many length or distance symbols",u.mode=30;break}u.have=0,u.mode=18;case 18:for(;u.have<u.ncode;){for(;N<3;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}u.lens[R[u.have++]]=7&S,S>>>=3,N-=3}for(;u.have<19;)u.lens[R[u.have++]]=0;if(u.lencode=u.lendyn,u.lenbits=7,A={bits:u.lenbits},z=l(0,u.lens,0,19,u.lencode,0,u.work,A),u.lenbits=A.bits,z){_.msg="invalid code lengths set",u.mode=30;break}u.have=0,u.mode=19;case 19:for(;u.have<u.nlen+u.ndist;){for(;et=(m=u.lencode[S&(1<<u.lenbits)-1])>>>16&255,at=65535&m,!((Q=m>>>24)<=N);){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}if(at<16)S>>>=Q,N-=Q,u.lens[u.have++]=at;else{if(at===16){for(y=Q+2;N<y;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}if(S>>>=Q,N-=Q,u.have===0){_.msg="invalid bit length repeat",u.mode=30;break}a=u.lens[u.have-1],Z=3+(3&S),S>>>=2,N-=2}else if(at===17){for(y=Q+3;N<y;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}N-=Q,a=0,Z=3+(7&(S>>>=Q)),S>>>=3,N-=3}else{for(y=Q+7;N<y;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}N-=Q,a=0,Z=11+(127&(S>>>=Q)),S>>>=7,N-=7}if(u.have+Z>u.nlen+u.ndist){_.msg="invalid bit length repeat",u.mode=30;break}for(;Z--;)u.lens[u.have++]=a}}if(u.mode===30)break;if(u.lens[256]===0){_.msg="invalid code -- missing end-of-block",u.mode=30;break}if(u.lenbits=9,A={bits:u.lenbits},z=l(c,u.lens,0,u.nlen,u.lencode,0,u.work,A),u.lenbits=A.bits,z){_.msg="invalid literal/lengths set",u.mode=30;break}if(u.distbits=6,u.distcode=u.distdyn,A={bits:u.distbits},z=l(h,u.lens,u.nlen,u.ndist,u.distcode,0,u.work,A),u.distbits=A.bits,z){_.msg="invalid distances set",u.mode=30;break}if(u.mode=20,P===6)break t;case 20:u.mode=21;case 21:if(6<=U&&258<=Y){_.next_out=J,_.avail_out=Y,_.next_in=M,_.avail_in=U,u.hold=S,u.bits=N,o(_,V),J=_.next_out,K=_.output,Y=_.avail_out,M=_.next_in,F=_.input,U=_.avail_in,S=u.hold,N=u.bits,u.mode===12&&(u.back=-1);break}for(u.back=0;et=(m=u.lencode[S&(1<<u.lenbits)-1])>>>16&255,at=65535&m,!((Q=m>>>24)<=N);){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}if(et&&(240&et)==0){for(it=Q,gt=et,pt=at;et=(m=u.lencode[pt+((S&(1<<it+gt)-1)>>it)])>>>16&255,at=65535&m,!(it+(Q=m>>>24)<=N);){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}S>>>=it,N-=it,u.back+=it}if(S>>>=Q,N-=Q,u.back+=Q,u.length=at,et===0){u.mode=26;break}if(32&et){u.back=-1,u.mode=12;break}if(64&et){_.msg="invalid literal/length code",u.mode=30;break}u.extra=15&et,u.mode=22;case 22:if(u.extra){for(y=u.extra;N<y;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}u.length+=S&(1<<u.extra)-1,S>>>=u.extra,N-=u.extra,u.back+=u.extra}u.was=u.length,u.mode=23;case 23:for(;et=(m=u.distcode[S&(1<<u.distbits)-1])>>>16&255,at=65535&m,!((Q=m>>>24)<=N);){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}if((240&et)==0){for(it=Q,gt=et,pt=at;et=(m=u.distcode[pt+((S&(1<<it+gt)-1)>>it)])>>>16&255,at=65535&m,!(it+(Q=m>>>24)<=N);){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}S>>>=it,N-=it,u.back+=it}if(S>>>=Q,N-=Q,u.back+=Q,64&et){_.msg="invalid distance code",u.mode=30;break}u.offset=at,u.extra=15&et,u.mode=24;case 24:if(u.extra){for(y=u.extra;N<y;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}u.offset+=S&(1<<u.extra)-1,S>>>=u.extra,N-=u.extra,u.back+=u.extra}if(u.offset>u.dmax){_.msg="invalid distance too far back",u.mode=30;break}u.mode=25;case 25:if(Y===0)break t;if(Z=V-Y,u.offset>Z){if((Z=u.offset-Z)>u.whave&&u.sane){_.msg="invalid distance too far back",u.mode=30;break}nt=Z>u.wnext?(Z-=u.wnext,u.wsize-Z):u.wnext-Z,Z>u.length&&(Z=u.length),lt=u.window}else lt=K,nt=J-u.offset,Z=u.length;for(Y<Z&&(Z=Y),Y-=Z,u.length-=Z;K[J++]=lt[nt++],--Z;);u.length===0&&(u.mode=21);break;case 26:if(Y===0)break t;K[J++]=u.length,Y--,u.mode=21;break;case 27:if(u.wrap){for(;N<32;){if(U===0)break t;U--,S|=F[M++]<<N,N+=8}if(V-=Y,_.total_out+=V,u.total+=V,V&&(_.adler=u.check=u.flags?r(u.check,K,V,J-V):i(u.check,K,V,J-V)),V=Y,(u.flags?S:p(S))!==u.check){_.msg="incorrect data check",u.mode=30;break}N=S=0}u.mode=28;case 28:if(u.wrap&&u.flags){for(;N<32;){if(U===0)break t;U--,S+=F[M++]<<N,N+=8}if(S!==(4294967295&u.total)){_.msg="incorrect length check",u.mode=30;break}N=S=0}u.mode=29;case 29:z=1;break t;case 30:z=-3;break t;case 31:return-4;case 32:default:return f}return _.next_out=J,_.avail_out=Y,_.next_in=M,_.avail_in=U,u.hold=S,u.bits=N,(u.wsize||V!==_.avail_out&&u.mode<30&&(u.mode<27||P!==4))&&q(_,_.output,_.next_out,V-_.avail_out)?(u.mode=31,-4):(G-=_.avail_in,V-=_.avail_out,_.total_in+=G,_.total_out+=V,u.total+=V,u.wrap&&V&&(_.adler=u.check=u.flags?r(u.check,K,V,_.next_out-V):i(u.check,K,V,_.next_out-V)),_.data_type=u.bits+(u.last?64:0)+(u.mode===12?128:0)+(u.mode===20||u.mode===15?256:0),(G==0&&V===0||P===4)&&z===g&&(z=-5),z)},t.inflateEnd=function(_){if(!_||!_.state)return f;var P=_.state;return P.window&&(P.window=null),_.state=null,g},t.inflateGetHeader=function(_,P){var u;return _&&_.state?(2&(u=_.state).wrap)==0?f:((u.head=P).done=!1,g):f},t.inflateSetDictionary=function(_,P){var u,F=P.length;return _&&_.state?(u=_.state).wrap!==0&&u.mode!==11?f:u.mode===11&&i(1,P,F,0)!==u.check?-3:q(_,P,F,F)?(u.mode=31,-4):(u.havedict=1,g):f},t.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(s,e,t){"use strict";var n=s("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(c,h,g,f,b,d,v,p){var w,x,E,C,B,O,$,T,W,q=p.bits,_=0,P=0,u=0,F=0,K=0,M=0,J=0,U=0,Y=0,S=0,N=null,G=0,V=new n.Buf16(16),Z=new n.Buf16(16),nt=null,lt=0;for(_=0;_<=15;_++)V[_]=0;for(P=0;P<f;P++)V[h[g+P]]++;for(K=q,F=15;1<=F&&V[F]===0;F--);if(F<K&&(K=F),F===0)return b[d++]=20971520,b[d++]=20971520,p.bits=1,0;for(u=1;u<F&&V[u]===0;u++);for(K<u&&(K=u),_=U=1;_<=15;_++)if(U<<=1,(U-=V[_])<0)return-1;if(0<U&&(c===0||F!==1))return-1;for(Z[1]=0,_=1;_<15;_++)Z[_+1]=Z[_]+V[_];for(P=0;P<f;P++)h[g+P]!==0&&(v[Z[h[g+P]]++]=P);if(O=c===0?(N=nt=v,19):c===1?(N=i,G-=257,nt=r,lt-=257,256):(N=o,nt=l,-1),_=u,B=d,J=P=S=0,E=-1,C=(Y=1<<(M=K))-1,c===1&&852<Y||c===2&&592<Y)return 1;for(;;){for($=_-J,W=v[P]<O?(T=0,v[P]):v[P]>O?(T=nt[lt+v[P]],N[G+v[P]]):(T=96,0),w=1<<_-J,u=x=1<<M;b[B+(S>>J)+(x-=w)]=$<<24|T<<16|W|0,x!==0;);for(w=1<<_-1;S&w;)w>>=1;if(w!==0?(S&=w-1,S+=w):S=0,P++,--V[_]==0){if(_===F)break;_=h[g+v[P]]}if(K<_&&(S&C)!==E){for(J===0&&(J=K),B+=u,U=1<<(M=_-J);M+J<F&&!((U-=V[M+J])<=0);)M++,U<<=1;if(Y+=1<<M,c===1&&852<Y||c===2&&592<Y)return 1;b[E=S&C]=K<<24|M<<16|B-d|0}}return S!==0&&(b[B+S]=_-J<<24|64<<16|0),p.bits=K,0}},{"../utils/common":41}],51:[function(s,e,t){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(s,e,t){"use strict";var n=s("../utils/common"),i=0,r=1;function o(m){for(var k=m.length;0<=--k;)m[k]=0}var l=0,c=29,h=256,g=h+1+c,f=30,b=19,d=2*g+1,v=15,p=16,w=7,x=256,E=16,C=17,B=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=new Array(2*(g+2));o(q);var _=new Array(2*f);o(_);var P=new Array(512);o(P);var u=new Array(256);o(u);var F=new Array(c);o(F);var K,M,J,U=new Array(f);function Y(m,k,R,L,I){this.static_tree=m,this.extra_bits=k,this.extra_base=R,this.elems=L,this.max_length=I,this.has_stree=m&&m.length}function S(m,k){this.dyn_tree=m,this.max_code=0,this.stat_desc=k}function N(m){return m<256?P[m]:P[256+(m>>>7)]}function G(m,k){m.pending_buf[m.pending++]=255&k,m.pending_buf[m.pending++]=k>>>8&255}function V(m,k,R){m.bi_valid>p-R?(m.bi_buf|=k<<m.bi_valid&65535,G(m,m.bi_buf),m.bi_buf=k>>p-m.bi_valid,m.bi_valid+=R-p):(m.bi_buf|=k<<m.bi_valid&65535,m.bi_valid+=R)}function Z(m,k,R){V(m,R[2*k],R[2*k+1])}function nt(m,k){for(var R=0;R|=1&m,m>>>=1,R<<=1,0<--k;);return R>>>1}function lt(m,k,R){var L,I,j=new Array(v+1),X=0;for(L=1;L<=v;L++)j[L]=X=X+R[L-1]<<1;for(I=0;I<=k;I++){var D=m[2*I+1];D!==0&&(m[2*I]=nt(j[D]++,D))}}function Q(m){var k;for(k=0;k<g;k++)m.dyn_ltree[2*k]=0;for(k=0;k<f;k++)m.dyn_dtree[2*k]=0;for(k=0;k<b;k++)m.bl_tree[2*k]=0;m.dyn_ltree[2*x]=1,m.opt_len=m.static_len=0,m.last_lit=m.matches=0}function et(m){8<m.bi_valid?G(m,m.bi_buf):0<m.bi_valid&&(m.pending_buf[m.pending++]=m.bi_buf),m.bi_buf=0,m.bi_valid=0}function at(m,k,R,L){var I=2*k,j=2*R;return m[I]<m[j]||m[I]===m[j]&&L[k]<=L[R]}function it(m,k,R){for(var L=m.heap[R],I=R<<1;I<=m.heap_len&&(I<m.heap_len&&at(k,m.heap[I+1],m.heap[I],m.depth)&&I++,!at(k,L,m.heap[I],m.depth));)m.heap[R]=m.heap[I],R=I,I<<=1;m.heap[R]=L}function gt(m,k,R){var L,I,j,X,D=0;if(m.last_lit!==0)for(;L=m.pending_buf[m.d_buf+2*D]<<8|m.pending_buf[m.d_buf+2*D+1],I=m.pending_buf[m.l_buf+D],D++,L===0?Z(m,I,k):(Z(m,(j=u[I])+h+1,k),(X=O[j])!==0&&V(m,I-=F[j],X),Z(m,j=N(--L),R),(X=$[j])!==0&&V(m,L-=U[j],X)),D<m.last_lit;);Z(m,x,k)}function pt(m,k){var R,L,I,j=k.dyn_tree,X=k.stat_desc.static_tree,D=k.stat_desc.has_stree,H=k.stat_desc.elems,rt=-1;for(m.heap_len=0,m.heap_max=d,R=0;R<H;R++)j[2*R]!==0?(m.heap[++m.heap_len]=rt=R,m.depth[R]=0):j[2*R+1]=0;for(;m.heap_len<2;)j[2*(I=m.heap[++m.heap_len]=rt<2?++rt:0)]=1,m.depth[I]=0,m.opt_len--,D&&(m.static_len-=X[2*I+1]);for(k.max_code=rt,R=m.heap_len>>1;1<=R;R--)it(m,j,R);for(I=H;R=m.heap[1],m.heap[1]=m.heap[m.heap_len--],it(m,j,1),L=m.heap[1],m.heap[--m.heap_max]=R,m.heap[--m.heap_max]=L,j[2*I]=j[2*R]+j[2*L],m.depth[I]=(m.depth[R]>=m.depth[L]?m.depth[R]:m.depth[L])+1,j[2*R+1]=j[2*L+1]=I,m.heap[1]=I++,it(m,j,1),2<=m.heap_len;);m.heap[--m.heap_max]=m.heap[1],(function(tt,dt){var Ct,vt,Et,st,zt,Xt,yt=dt.dyn_tree,ee=dt.max_code,ye=dt.stat_desc.static_tree,we=dt.stat_desc.has_stree,_e=dt.stat_desc.extra_bits,re=dt.stat_desc.extra_base,It=dt.stat_desc.max_length,Ft=0;for(st=0;st<=v;st++)tt.bl_count[st]=0;for(yt[2*tt.heap[tt.heap_max]+1]=0,Ct=tt.heap_max+1;Ct<d;Ct++)It<(st=yt[2*yt[2*(vt=tt.heap[Ct])+1]+1]+1)&&(st=It,Ft++),yt[2*vt+1]=st,ee<vt||(tt.bl_count[st]++,zt=0,re<=vt&&(zt=_e[vt-re]),Xt=yt[2*vt],tt.opt_len+=Xt*(st+zt),we&&(tt.static_len+=Xt*(ye[2*vt+1]+zt)));if(Ft!==0){do{for(st=It-1;tt.bl_count[st]===0;)st--;tt.bl_count[st]--,tt.bl_count[st+1]+=2,tt.bl_count[It]--,Ft-=2}while(0<Ft);for(st=It;st!==0;st--)for(vt=tt.bl_count[st];vt!==0;)ee<(Et=tt.heap[--Ct])||(yt[2*Et+1]!==st&&(tt.opt_len+=(st-yt[2*Et+1])*yt[2*Et],yt[2*Et+1]=st),vt--)}})(m,k),lt(j,rt,m.bl_count)}function a(m,k,R){var L,I,j=-1,X=k[1],D=0,H=7,rt=4;for(X===0&&(H=138,rt=3),k[2*(R+1)+1]=65535,L=0;L<=R;L++)I=X,X=k[2*(L+1)+1],++D<H&&I===X||(D<rt?m.bl_tree[2*I]+=D:I!==0?(I!==j&&m.bl_tree[2*I]++,m.bl_tree[2*E]++):D<=10?m.bl_tree[2*C]++:m.bl_tree[2*B]++,j=I,rt=(D=0)===X?(H=138,3):I===X?(H=6,3):(H=7,4))}function z(m,k,R){var L,I,j=-1,X=k[1],D=0,H=7,rt=4;for(X===0&&(H=138,rt=3),L=0;L<=R;L++)if(I=X,X=k[2*(L+1)+1],!(++D<H&&I===X)){if(D<rt)for(;Z(m,I,m.bl_tree),--D!=0;);else I!==0?(I!==j&&(Z(m,I,m.bl_tree),D--),Z(m,E,m.bl_tree),V(m,D-3,2)):D<=10?(Z(m,C,m.bl_tree),V(m,D-3,3)):(Z(m,B,m.bl_tree),V(m,D-11,7));j=I,rt=(D=0)===X?(H=138,3):I===X?(H=6,3):(H=7,4)}}o(U);var A=!1;function y(m,k,R,L){V(m,(l<<1)+(L?1:0),3),(function(I,j,X,D){et(I),D&&(G(I,X),G(I,~X)),n.arraySet(I.pending_buf,I.window,j,X,I.pending),I.pending+=X})(m,k,R,!0)}t._tr_init=function(m){A||((function(){var k,R,L,I,j,X=new Array(v+1);for(I=L=0;I<c-1;I++)for(F[I]=L,k=0;k<1<<O[I];k++)u[L++]=I;for(u[L-1]=I,I=j=0;I<16;I++)for(U[I]=j,k=0;k<1<<$[I];k++)P[j++]=I;for(j>>=7;I<f;I++)for(U[I]=j<<7,k=0;k<1<<$[I]-7;k++)P[256+j++]=I;for(R=0;R<=v;R++)X[R]=0;for(k=0;k<=143;)q[2*k+1]=8,k++,X[8]++;for(;k<=255;)q[2*k+1]=9,k++,X[9]++;for(;k<=279;)q[2*k+1]=7,k++,X[7]++;for(;k<=287;)q[2*k+1]=8,k++,X[8]++;for(lt(q,g+1,X),k=0;k<f;k++)_[2*k+1]=5,_[2*k]=nt(k,5);K=new Y(q,O,h+1,g,v),M=new Y(_,$,0,f,v),J=new Y(new Array(0),T,0,b,w)})(),A=!0),m.l_desc=new S(m.dyn_ltree,K),m.d_desc=new S(m.dyn_dtree,M),m.bl_desc=new S(m.bl_tree,J),m.bi_buf=0,m.bi_valid=0,Q(m)},t._tr_stored_block=y,t._tr_flush_block=function(m,k,R,L){var I,j,X=0;0<m.level?(m.strm.data_type===2&&(m.strm.data_type=(function(D){var H,rt=4093624447;for(H=0;H<=31;H++,rt>>>=1)if(1&rt&&D.dyn_ltree[2*H]!==0)return i;if(D.dyn_ltree[18]!==0||D.dyn_ltree[20]!==0||D.dyn_ltree[26]!==0)return r;for(H=32;H<h;H++)if(D.dyn_ltree[2*H]!==0)return r;return i})(m)),pt(m,m.l_desc),pt(m,m.d_desc),X=(function(D){var H;for(a(D,D.dyn_ltree,D.l_desc.max_code),a(D,D.dyn_dtree,D.d_desc.max_code),pt(D,D.bl_desc),H=b-1;3<=H&&D.bl_tree[2*W[H]+1]===0;H--);return D.opt_len+=3*(H+1)+5+5+4,H})(m),I=m.opt_len+3+7>>>3,(j=m.static_len+3+7>>>3)<=I&&(I=j)):I=j=R+5,R+4<=I&&k!==-1?y(m,k,R,L):m.strategy===4||j===I?(V(m,2+(L?1:0),3),gt(m,q,_)):(V(m,4+(L?1:0),3),(function(D,H,rt,tt){var dt;for(V(D,H-257,5),V(D,rt-1,5),V(D,tt-4,4),dt=0;dt<tt;dt++)V(D,D.bl_tree[2*W[dt]+1],3);z(D,D.dyn_ltree,H-1),z(D,D.dyn_dtree,rt-1)})(m,m.l_desc.max_code+1,m.d_desc.max_code+1,X+1),gt(m,m.dyn_ltree,m.dyn_dtree)),Q(m),L&&et(m)},t._tr_tally=function(m,k,R){return m.pending_buf[m.d_buf+2*m.last_lit]=k>>>8&255,m.pending_buf[m.d_buf+2*m.last_lit+1]=255&k,m.pending_buf[m.l_buf+m.last_lit]=255&R,m.last_lit++,k===0?m.dyn_ltree[2*R]++:(m.matches++,k--,m.dyn_ltree[2*(u[R]+h+1)]++,m.dyn_dtree[2*N(k)]++),m.last_lit===m.lit_bufsize-1},t._tr_align=function(m){V(m,2,3),Z(m,x,q),(function(k){k.bi_valid===16?(G(k,k.bi_buf),k.bi_buf=0,k.bi_valid=0):8<=k.bi_valid&&(k.pending_buf[k.pending++]=255&k.bi_buf,k.bi_buf>>=8,k.bi_valid-=8)})(m)}},{"../utils/common":41}],53:[function(s,e,t){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(s,e,t){(function(n){(function(i,r){"use strict";if(!i.setImmediate){var o,l,c,h,g=1,f={},b=!1,d=i.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(i);v=v&&v.setTimeout?v:i,o={}.toString.call(i.process)==="[object process]"?function(E){process.nextTick(function(){w(E)})}:(function(){if(i.postMessage&&!i.importScripts){var E=!0,C=i.onmessage;return i.onmessage=function(){E=!1},i.postMessage("","*"),i.onmessage=C,E}})()?(h="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",x,!1):i.attachEvent("onmessage",x),function(E){i.postMessage(h+E,"*")}):i.MessageChannel?((c=new MessageChannel).port1.onmessage=function(E){w(E.data)},function(E){c.port2.postMessage(E)}):d&&"onreadystatechange"in d.createElement("script")?(l=d.documentElement,function(E){var C=d.createElement("script");C.onreadystatechange=function(){w(E),C.onreadystatechange=null,l.removeChild(C),C=null},l.appendChild(C)}):function(E){setTimeout(w,0,E)},v.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var C=new Array(arguments.length-1),B=0;B<C.length;B++)C[B]=arguments[B+1];var O={callback:E,args:C};return f[g]=O,o(g),g++},v.clearImmediate=p}function p(E){delete f[E]}function w(E){if(b)setTimeout(w,0,E);else{var C=f[E];if(C){b=!0;try{(function(B){var O=B.callback,$=B.args;switch($.length){case 0:O();break;case 1:O($[0]);break;case 2:O($[0],$[1]);break;case 3:O($[0],$[1],$[2]);break;default:O.apply(r,$)}})(C)}finally{p(E),b=!1}}}}function x(E){E.source===i&&typeof E.data=="string"&&E.data.indexOf(h)===0&&w(+E.data.slice(h.length))}})(typeof self=="undefined"?n===void 0?this:n:self)}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})});var fr={};Se(fr,{default:()=>Vt});module.exports=Te(fr);var mt=require("obsidian");var Ht={imageFolder:"attachments",useRelativeImagePaths:!0,formulaFormat:"latex",preserveLineBreaks:!0,tableAlignment:"left",defaultImageWidth:600,createImageFolder:!0,handleNumbering:!0};var me=Ae(se());var oe=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",Oe=oe+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",Pe="["+oe+"]["+Oe+"]*",ze=new RegExp("^"+Pe+"$");function Rt(s,e){let t=[],n=e.exec(s);for(;n;){let i=[];i.startIndex=e.lastIndex-n[0].length;let r=n.length;for(let o=0;o<r;o++)i.push(n[o]);t.push(i),n=e.exec(s)}return t}var kt=function(s){let e=ze.exec(s);return!(e===null||typeof e=="undefined")};function ae(s){return typeof s!="undefined"}var Fe={allowBooleanAttributes:!1,unpairedTags:[]};function fe(s,e){e=Object.assign({},Fe,e);let t=[],n=!1,i=!1;s[0]==="\uFEFF"&&(s=s.substr(1));for(let r=0;r<s.length;r++)if(s[r]==="<"&&s[r+1]==="?"){if(r+=2,r=ce(s,r),r.err)return r}else if(s[r]==="<"){let o=r;if(r++,s[r]==="!"){r=ue(s,r);continue}else{let l=!1;s[r]==="/"&&(l=!0,r++);let c="";for(;r<s.length&&s[r]!==">"&&s[r]!==" "&&s[r]!=="	"&&s[r]!==`
`&&s[r]!=="\r";r++)c+=s[r];if(c=c.trim(),c[c.length-1]==="/"&&(c=c.substring(0,c.length-1),r--),!De(c)){let f;return c.trim().length===0?f="Invalid space after '<'.":f="Tag '"+c+"' is an invalid name.",ot("InvalidTag",f,ct(s,r))}let h=Le(s,r);if(h===!1)return ot("InvalidAttr","Attributes for '"+c+"' have open quote.",ct(s,r));let g=h.value;if(r=h.index,g[g.length-1]==="/"){let f=r-g.length;g=g.substring(0,g.length-1);let b=he(g,e);if(b===!0)n=!0;else return ot(b.err.code,b.err.msg,ct(s,f+b.err.line))}else if(l)if(h.tagClosed){if(g.trim().length>0)return ot("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",ct(s,o));if(t.length===0)return ot("InvalidTag","Closing tag '"+c+"' has not been opened.",ct(s,o));{let f=t.pop();if(c!==f.tagName){let b=ct(s,f.tagStartPos);return ot("InvalidTag","Expected closing tag '"+f.tagName+"' (opened in line "+b.line+", col "+b.col+") instead of closing tag '"+c+"'.",ct(s,o))}t.length==0&&(i=!0)}}else return ot("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",ct(s,r));else{let f=he(g,e);if(f!==!0)return ot(f.err.code,f.err.msg,ct(s,r-g.length+f.err.line));if(i===!0)return ot("InvalidXml","Multiple possible root nodes found.",ct(s,r));e.unpairedTags.indexOf(c)!==-1||t.push({tagName:c,tagStartPos:o}),n=!0}for(r++;r<s.length;r++)if(s[r]==="<")if(s[r+1]==="!"){r++,r=ue(s,r);continue}else if(s[r+1]==="?"){if(r=ce(s,++r),r.err)return r}else break;else if(s[r]==="&"){let f=Ue(s,r);if(f==-1)return ot("InvalidChar","char '&' is not expected.",ct(s,r));r=f}else if(i===!0&&!le(s[r]))return ot("InvalidXml","Extra text at the end",ct(s,r));s[r]==="<"&&r--}}else{if(le(s[r]))continue;return ot("InvalidChar","char '"+s[r]+"' is not expected.",ct(s,r))}if(n){if(t.length==1)return ot("InvalidTag","Unclosed tag '"+t[0].tagName+"'.",ct(s,t[0].tagStartPos));if(t.length>0)return ot("InvalidXml","Invalid '"+JSON.stringify(t.map(r=>r.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return ot("InvalidXml","Start tag expected.",1);return!0}function le(s){return s===" "||s==="	"||s===`
`||s==="\r"}function ce(s,e){let t=e;for(;e<s.length;e++)if(s[e]=="?"||s[e]==" "){let n=s.substr(t,e-t);if(e>5&&n==="xml")return ot("InvalidXml","XML declaration allowed only at the start of the document.",ct(s,e));if(s[e]=="?"&&s[e+1]==">"){e++;break}else continue}return e}function ue(s,e){if(s.length>e+5&&s[e+1]==="-"&&s[e+2]==="-"){for(e+=3;e<s.length;e++)if(s[e]==="-"&&s[e+1]==="-"&&s[e+2]===">"){e+=2;break}}else if(s.length>e+8&&s[e+1]==="D"&&s[e+2]==="O"&&s[e+3]==="C"&&s[e+4]==="T"&&s[e+5]==="Y"&&s[e+6]==="P"&&s[e+7]==="E"){let t=1;for(e+=8;e<s.length;e++)if(s[e]==="<")t++;else if(s[e]===">"&&(t--,t===0))break}else if(s.length>e+9&&s[e+1]==="["&&s[e+2]==="C"&&s[e+3]==="D"&&s[e+4]==="A"&&s[e+5]==="T"&&s[e+6]==="A"&&s[e+7]==="["){for(e+=8;e<s.length;e++)if(s[e]==="]"&&s[e+1]==="]"&&s[e+2]===">"){e+=2;break}}return e}var Be='"',Re="'";function Le(s,e){let t="",n="",i=!1;for(;e<s.length;e++){if(s[e]===Be||s[e]===Re)n===""?n=s[e]:n!==s[e]||(n="");else if(s[e]===">"&&n===""){i=!0;break}t+=s[e]}return n!==""?!1:{value:t,index:e,tagClosed:i}}var Me=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function he(s,e){let t=Rt(s,Me),n={};for(let i=0;i<t.length;i++){if(t[i][1].length===0)return ot("InvalidAttr","Attribute '"+t[i][2]+"' has no space in starting.",Nt(t[i]));if(t[i][3]!==void 0&&t[i][4]===void 0)return ot("InvalidAttr","Attribute '"+t[i][2]+"' is without value.",Nt(t[i]));if(t[i][3]===void 0&&!e.allowBooleanAttributes)return ot("InvalidAttr","boolean attribute '"+t[i][2]+"' is not allowed.",Nt(t[i]));let r=t[i][2];if(!je(r))return ot("InvalidAttr","Attribute '"+r+"' is an invalid name.",Nt(t[i]));if(!n.hasOwnProperty(r))n[r]=1;else return ot("InvalidAttr","Attribute '"+r+"' is repeated.",Nt(t[i]))}return!0}function $e(s,e){let t=/\d/;for(s[e]==="x"&&(e++,t=/[\da-fA-F]/);e<s.length;e++){if(s[e]===";")return e;if(!s[e].match(t))break}return-1}function Ue(s,e){if(e++,s[e]===";")return-1;if(s[e]==="#")return e++,$e(s,e);let t=0;for(;e<s.length;e++,t++)if(!(s[e].match(/\w/)&&t<20)){if(s[e]===";")break;return-1}return e}function ot(s,e,t){return{err:{code:s,msg:e,line:t.line||t,col:t.col}}}function je(s){return kt(s)}function De(s){return kt(s)}function ct(s,e){let t=s.substring(0,e).split(/\r?\n/);return{line:t.length,col:t[t.length-1].length+1}}function Nt(s){return s.startIndex+s[1].length}var We={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(s,e){return e},attributeValueProcessor:function(s,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(s,e,t){return s},captureMetaData:!1},de=function(s){return Object.assign({},We,s)};var Lt;typeof Symbol!="function"?Lt="@@xmlMetadata":Lt=Symbol("XML Node Metadata");var ft=class{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e,t){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child}),t!==void 0&&(this.child[this.child.length-1][Lt]={startIndex:t})}static getMetaDataSymbol(){return Lt}};var At=class{constructor(e){this.suppressValidationErr=!e}readDocType(e,t){let n={};if(e[t+3]==="O"&&e[t+4]==="C"&&e[t+5]==="T"&&e[t+6]==="Y"&&e[t+7]==="P"&&e[t+8]==="E"){t=t+9;let i=1,r=!1,o=!1,l="";for(;t<e.length;t++)if(e[t]==="<"&&!o){if(r&&_t(e,"!ENTITY",t)){t+=7;let c,h;[c,h,t]=this.readEntityExp(e,t+1,this.suppressValidationErr),h.indexOf("&")===-1&&(n[c]={regx:RegExp(`&${c};`,"g"),val:h})}else if(r&&_t(e,"!ELEMENT",t)){t+=8;let{index:c}=this.readElementExp(e,t+1);t=c}else if(r&&_t(e,"!ATTLIST",t))t+=8;else if(r&&_t(e,"!NOTATION",t)){t+=9;let{index:c}=this.readNotationExp(e,t+1,this.suppressValidationErr);t=c}else if(_t(e,"!--",t))o=!0;else throw new Error("Invalid DOCTYPE");i++,l=""}else if(e[t]===">"){if(o?e[t-1]==="-"&&e[t-2]==="-"&&(o=!1,i--):i--,i===0)break}else e[t]==="["?r=!0:l+=e[t];if(i!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:n,i:t}}readEntityExp(e,t){t=ut(e,t);let n="";for(;t<e.length&&!/\s/.test(e[t])&&e[t]!=='"'&&e[t]!=="'";)n+=e[t],t++;if(St(n),t=ut(e,t),!this.suppressValidationErr){if(e.substring(t,t+6).toUpperCase()==="SYSTEM")throw new Error("External entities are not supported");if(e[t]==="%")throw new Error("Parameter entities are not supported")}let i="";return[t,i]=this.readIdentifierVal(e,t,"entity"),t--,[n,i,t]}readNotationExp(e,t){t=ut(e,t);let n="";for(;t<e.length&&!/\s/.test(e[t]);)n+=e[t],t++;!this.suppressValidationErr&&St(n),t=ut(e,t);let i=e.substring(t,t+6).toUpperCase();if(!this.suppressValidationErr&&i!=="SYSTEM"&&i!=="PUBLIC")throw new Error(`Expected SYSTEM or PUBLIC, found "${i}"`);t+=i.length,t=ut(e,t);let r=null,o=null;if(i==="PUBLIC")[t,r]=this.readIdentifierVal(e,t,"publicIdentifier"),t=ut(e,t),(e[t]==='"'||e[t]==="'")&&([t,o]=this.readIdentifierVal(e,t,"systemIdentifier"));else if(i==="SYSTEM"&&([t,o]=this.readIdentifierVal(e,t,"systemIdentifier"),!this.suppressValidationErr&&!o))throw new Error("Missing mandatory system identifier for SYSTEM notation");return{notationName:n,publicIdentifier:r,systemIdentifier:o,index:--t}}readIdentifierVal(e,t,n){let i="",r=e[t];if(r!=='"'&&r!=="'")throw new Error(`Expected quoted string, found "${r}"`);for(t++;t<e.length&&e[t]!==r;)i+=e[t],t++;if(e[t]!==r)throw new Error(`Unterminated ${n} value`);return t++,[t,i]}readElementExp(e,t){t=ut(e,t);let n="";for(;t<e.length&&!/\s/.test(e[t]);)n+=e[t],t++;if(!this.suppressValidationErr&&!kt(n))throw new Error(`Invalid element name: "${n}"`);t=ut(e,t);let i="";if(e[t]==="E"&&_t(e,"MPTY",t))t+=4;else if(e[t]==="A"&&_t(e,"NY",t))t+=2;else if(e[t]==="("){for(t++;t<e.length&&e[t]!==")";)i+=e[t],t++;if(e[t]!==")")throw new Error("Unterminated content model")}else if(!this.suppressValidationErr)throw new Error(`Invalid Element Expression, found "${e[t]}"`);return{elementName:n,contentModel:i.trim(),index:t}}readAttlistExp(e,t){t=ut(e,t);let n="";for(;t<e.length&&!/\s/.test(e[t]);)n+=e[t],t++;St(n),t=ut(e,t);let i="";for(;t<e.length&&!/\s/.test(e[t]);)i+=e[t],t++;if(!St(i))throw new Error(`Invalid attribute name: "${i}"`);t=ut(e,t);let r="";if(e.substring(t,t+8).toUpperCase()==="NOTATION"){if(r="NOTATION",t+=8,t=ut(e,t),e[t]!=="(")throw new Error(`Expected '(', found "${e[t]}"`);t++;let l=[];for(;t<e.length&&e[t]!==")";){let c="";for(;t<e.length&&e[t]!=="|"&&e[t]!==")";)c+=e[t],t++;if(c=c.trim(),!St(c))throw new Error(`Invalid notation name: "${c}"`);l.push(c),e[t]==="|"&&(t++,t=ut(e,t))}if(e[t]!==")")throw new Error("Unterminated list of notations");t++,r+=" ("+l.join("|")+")"}else{for(;t<e.length&&!/\s/.test(e[t]);)r+=e[t],t++;let l=["CDATA","ID","IDREF","IDREFS","ENTITY","ENTITIES","NMTOKEN","NMTOKENS"];if(!this.suppressValidationErr&&!l.includes(r.toUpperCase()))throw new Error(`Invalid attribute type: "${r}"`)}t=ut(e,t);let o="";return e.substring(t,t+8).toUpperCase()==="#REQUIRED"?(o="#REQUIRED",t+=8):e.substring(t,t+7).toUpperCase()==="#IMPLIED"?(o="#IMPLIED",t+=7):[t,o]=this.readIdentifierVal(e,t,"ATTLIST"),{elementName:n,attributeName:i,attributeType:r,defaultValue:o,index:t}}},ut=(s,e)=>{for(;e<s.length&&/\s/.test(s[e]);)e++;return e};function _t(s,e,t){for(let n=0;n<e.length;n++)if(e[n]!==s[t+n+1])return!1;return!0}function St(s){if(kt(s))return s;throw new Error(`Invalid entity name ${s}`)}var Ze=/^[-+]?0x[a-fA-F0-9]+$/,Ve=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,Xe={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function qt(s,e={}){if(e=Object.assign({},Xe,e),!s||typeof s!="string")return s;let t=s.trim();if(e.skipLike!==void 0&&e.skipLike.test(t))return s;if(s==="0")return 0;if(e.hex&&Ze.test(t))return Ye(t,16);if(t.search(/.+[eE].+/)!==-1)return Ge(s,t,e);{let n=Ve.exec(t);if(n){let i=n[1]||"",r=n[2],o=qe(n[3]),l=i?s[r.length+1]===".":s[r.length]===".";if(!e.leadingZeros&&(r.length>1||r.length===1&&!l))return s;{let c=Number(t),h=String(c);if(c===0)return c;if(h.search(/[eE]/)!==-1)return e.eNotation?c:s;if(t.indexOf(".")!==-1)return h==="0"||h===o||h===`${i}${o}`?c:s;let g=r?o:t;return r?g===h||i+g===h?c:s:g===h||g===i+h?c:s}}else return s}}var He=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;function Ge(s,e,t){if(!t.eNotation)return s;let n=e.match(He);if(n){let i=n[1]||"",r=n[3].indexOf("e")===-1?"E":"e",o=n[2],l=i?s[o.length+1]===r:s[o.length]===r;return o.length>1&&l?s:o.length===1&&(n[3].startsWith(`.${r}`)||n[3][0]===r)?Number(e):t.leadingZeros&&!l?(e=(n[1]||"")+n[3],Number(e)):s}else return s}function qe(s){return s&&s.indexOf(".")!==-1&&(s=s.replace(/0+$/,""),s==="."?s="0":s[0]==="."?s="0"+s:s[s.length-1]==="."&&(s=s.substring(0,s.length-1))),s}function Ye(s,e){if(parseInt)return parseInt(s,e);if(Number.parseInt)return Number.parseInt(s,e);if(window&&window.parseInt)return window.parseInt(s,e);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}function Yt(s){return typeof s=="function"?s:Array.isArray(s)?e=>{for(let t of s)if(typeof t=="string"&&e===t||t instanceof RegExp&&t.test(e))return!0}:()=>!1}var Tt=class{constructor(e){if(this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"\xA2"},pound:{regex:/&(pound|#163);/g,val:"\xA3"},yen:{regex:/&(yen|#165);/g,val:"\xA5"},euro:{regex:/&(euro|#8364);/g,val:"\u20AC"},copyright:{regex:/&(copy|#169);/g,val:"\xA9"},reg:{regex:/&(reg|#174);/g,val:"\xAE"},inr:{regex:/&(inr|#8377);/g,val:"\u20B9"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(t,n)=>String.fromCodePoint(Number.parseInt(n,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(t,n)=>String.fromCodePoint(Number.parseInt(n,16))}},this.addExternalEntities=Ke,this.parseXml=rr,this.parseTextData=Je,this.resolveNameSpace=Qe,this.buildAttributesMap=er,this.isItStopNode=or,this.replaceEntitiesValue=ir,this.readStopNodeData=lr,this.saveTextToParentTag=sr,this.addChild=nr,this.ignoreAttributesFn=Yt(this.options.ignoreAttributes),this.options.stopNodes&&this.options.stopNodes.length>0){this.stopNodesExact=new Set,this.stopNodesWildcard=new Set;for(let t=0;t<this.options.stopNodes.length;t++){let n=this.options.stopNodes[t];typeof n=="string"&&(n.startsWith("*.")?this.stopNodesWildcard.add(n.substring(2)):this.stopNodesExact.add(n))}}}};function Ke(s){let e=Object.keys(s);for(let t=0;t<e.length;t++){let n=e[t];this.lastEntities[n]={regex:new RegExp("&"+n+";","g"),val:s[n]}}}function Je(s,e,t,n,i,r,o){if(s!==void 0&&(this.options.trimValues&&!n&&(s=s.trim()),s.length>0)){o||(s=this.replaceEntitiesValue(s));let l=this.options.tagValueProcessor(e,s,t,i,r);return l==null?s:typeof l!=typeof s||l!==s?l:this.options.trimValues?Jt(s,this.options.parseTagValue,this.options.numberParseOptions):s.trim()===s?Jt(s,this.options.parseTagValue,this.options.numberParseOptions):s}}function Qe(s){if(this.options.removeNSPrefix){let e=s.split(":"),t=s.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(s=t+e[1])}return s}var tr=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function er(s,e,t){if(this.options.ignoreAttributes!==!0&&typeof s=="string"){let n=Rt(s,tr),i=n.length,r={};for(let o=0;o<i;o++){let l=this.resolveNameSpace(n[o][1]);if(this.ignoreAttributesFn(l,e))continue;let c=n[o][4],h=this.options.attributeNamePrefix+l;if(l.length)if(this.options.transformAttributeName&&(h=this.options.transformAttributeName(h)),h==="__proto__"&&(h="#__proto__"),c!==void 0){this.options.trimValues&&(c=c.trim()),c=this.replaceEntitiesValue(c);let g=this.options.attributeValueProcessor(l,c,e);g==null?r[h]=c:typeof g!=typeof c||g!==c?r[h]=g:r[h]=Jt(c,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(r[h]=!0)}if(!Object.keys(r).length)return;if(this.options.attributesGroupName){let o={};return o[this.options.attributesGroupName]=r,o}return r}}var rr=function(s){s=s.replace(/\r\n?/g,`
`);let e=new ft("!xml"),t=e,n="",i="",r=new At(this.options.processEntities);for(let o=0;o<s.length;o++)if(s[o]==="<")if(s[o+1]==="/"){let c=xt(s,">",o,"Closing Tag is not closed."),h=s.substring(o+2,c).trim();if(this.options.removeNSPrefix){let b=h.indexOf(":");b!==-1&&(h=h.substr(b+1))}this.options.transformTagName&&(h=this.options.transformTagName(h)),t&&(n=this.saveTextToParentTag(n,t,i));let g=i.substring(i.lastIndexOf(".")+1);if(h&&this.options.unpairedTags.indexOf(h)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${h}>`);let f=0;g&&this.options.unpairedTags.indexOf(g)!==-1?(f=i.lastIndexOf(".",i.lastIndexOf(".")-1),this.tagsNodeStack.pop()):f=i.lastIndexOf("."),i=i.substring(0,f),t=this.tagsNodeStack.pop(),n="",o=c}else if(s[o+1]==="?"){let c=Kt(s,o,!1,"?>");if(!c)throw new Error("Pi Tag is not closed.");if(n=this.saveTextToParentTag(n,t,i),!(this.options.ignoreDeclaration&&c.tagName==="?xml"||this.options.ignorePiTags)){let h=new ft(c.tagName);h.add(this.options.textNodeName,""),c.tagName!==c.tagExp&&c.attrExpPresent&&(h[":@"]=this.buildAttributesMap(c.tagExp,i,c.tagName)),this.addChild(t,h,i,o)}o=c.closeIndex+1}else if(s.substr(o+1,3)==="!--"){let c=xt(s,"-->",o+4,"Comment is not closed.");if(this.options.commentPropName){let h=s.substring(o+4,c-2);n=this.saveTextToParentTag(n,t,i),t.add(this.options.commentPropName,[{[this.options.textNodeName]:h}])}o=c}else if(s.substr(o+1,2)==="!D"){let c=r.readDocType(s,o);this.docTypeEntities=c.entities,o=c.i}else if(s.substr(o+1,2)==="!["){let c=xt(s,"]]>",o,"CDATA is not closed.")-2,h=s.substring(o+9,c);n=this.saveTextToParentTag(n,t,i);let g=this.parseTextData(h,t.tagname,i,!0,!1,!0,!0);g==null&&(g=""),this.options.cdataPropName?t.add(this.options.cdataPropName,[{[this.options.textNodeName]:h}]):t.add(this.options.textNodeName,g),o=c+2}else{let c=Kt(s,o,this.options.removeNSPrefix),h=c.tagName,g=c.rawTagName,f=c.tagExp,b=c.attrExpPresent,d=c.closeIndex;this.options.transformTagName&&(h=this.options.transformTagName(h)),t&&n&&t.tagname!=="!xml"&&(n=this.saveTextToParentTag(n,t,i,!1));let v=t;v&&this.options.unpairedTags.indexOf(v.tagname)!==-1&&(t=this.tagsNodeStack.pop(),i=i.substring(0,i.lastIndexOf("."))),h!==e.tagname&&(i+=i?"."+h:h);let p=o;if(this.isItStopNode(this.stopNodesExact,this.stopNodesWildcard,i,h)){let w="";if(f.length>0&&f.lastIndexOf("/")===f.length-1)h[h.length-1]==="/"?(h=h.substr(0,h.length-1),i=i.substr(0,i.length-1),f=h):f=f.substr(0,f.length-1),o=c.closeIndex;else if(this.options.unpairedTags.indexOf(h)!==-1)o=c.closeIndex;else{let E=this.readStopNodeData(s,g,d+1);if(!E)throw new Error(`Unexpected end of ${g}`);o=E.i,w=E.tagContent}let x=new ft(h);h!==f&&b&&(x[":@"]=this.buildAttributesMap(f,i,h)),w&&(w=this.parseTextData(w,h,i,!0,b,!0,!0)),i=i.substr(0,i.lastIndexOf(".")),x.add(this.options.textNodeName,w),this.addChild(t,x,i,p)}else{if(f.length>0&&f.lastIndexOf("/")===f.length-1){h[h.length-1]==="/"?(h=h.substr(0,h.length-1),i=i.substr(0,i.length-1),f=h):f=f.substr(0,f.length-1),this.options.transformTagName&&(h=this.options.transformTagName(h));let w=new ft(h);h!==f&&b&&(w[":@"]=this.buildAttributesMap(f,i,h)),this.addChild(t,w,i,p),i=i.substr(0,i.lastIndexOf("."))}else{let w=new ft(h);this.tagsNodeStack.push(t),h!==f&&b&&(w[":@"]=this.buildAttributesMap(f,i,h)),this.addChild(t,w,i,p),t=w}n="",o=d}}else n+=s[o];return e.child};function nr(s,e,t,n){this.options.captureMetaData||(n=void 0);let i=this.options.updateTag(e.tagname,t,e[":@"]);i===!1||(typeof i=="string"&&(e.tagname=i),s.addChild(e,n))}var ir=function(s){if(this.options.processEntities){for(let e in this.docTypeEntities){let t=this.docTypeEntities[e];s=s.replace(t.regx,t.val)}for(let e in this.lastEntities){let t=this.lastEntities[e];s=s.replace(t.regex,t.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){let t=this.htmlEntities[e];s=s.replace(t.regex,t.val)}s=s.replace(this.ampEntity.regex,this.ampEntity.val)}return s};function sr(s,e,t,n){return s&&(n===void 0&&(n=e.child.length===0),s=this.parseTextData(s,e.tagname,t,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,n),s!==void 0&&s!==""&&e.add(this.options.textNodeName,s),s=""),s}function or(s,e,t,n){return!!(e&&e.has(n)||s&&s.has(t))}function ar(s,e,t=">"){let n,i="";for(let r=e;r<s.length;r++){let o=s[r];if(n)o===n&&(n="");else if(o==='"'||o==="'")n=o;else if(o===t[0])if(t[1]){if(s[r+1]===t[1])return{data:i,index:r}}else return{data:i,index:r};else o==="	"&&(o=" ");i+=o}}function xt(s,e,t,n){let i=s.indexOf(e,t);if(i===-1)throw new Error(n);return i+e.length-1}function Kt(s,e,t,n=">"){let i=ar(s,e+1,n);if(!i)return;let r=i.data,o=i.index,l=r.search(/\s/),c=r,h=!0;l!==-1&&(c=r.substring(0,l),r=r.substring(l+1).trimStart());let g=c;if(t){let f=c.indexOf(":");f!==-1&&(c=c.substr(f+1),h=c!==i.data.substr(f+1))}return{tagName:c,tagExp:r,closeIndex:o,attrExpPresent:h,rawTagName:g}}function lr(s,e,t){let n=t,i=1;for(;t<s.length;t++)if(s[t]==="<")if(s[t+1]==="/"){let r=xt(s,">",t,`${e} is not closed`);if(s.substring(t+2,r).trim()===e&&(i--,i===0))return{tagContent:s.substring(n,t),i:r};t=r}else if(s[t+1]==="?")t=xt(s,"?>",t+1,"StopNode is not closed.");else if(s.substr(t+1,3)==="!--")t=xt(s,"-->",t+3,"StopNode is not closed.");else if(s.substr(t+1,2)==="![")t=xt(s,"]]>",t,"StopNode is not closed.")-2;else{let r=Kt(s,t,">");r&&((r&&r.tagName)===e&&r.tagExp[r.tagExp.length-1]!=="/"&&i++,t=r.closeIndex)}}function Jt(s,e,t){if(e&&typeof s=="string"){let n=s.trim();return n==="true"?!0:n==="false"?!1:qt(s,t)}else return ae(s)?s:""}var Qt=ft.getMetaDataSymbol();function te(s,e){return pe(s,e)}function pe(s,e,t){let n,i={};for(let r=0;r<s.length;r++){let o=s[r],l=cr(o),c="";if(t===void 0?c=l:c=t+"."+l,l===e.textNodeName)n===void 0?n=o[l]:n+=""+o[l];else{if(l===void 0)continue;if(o[l]){let h=pe(o[l],e,c),g=hr(h,e);o[Qt]!==void 0&&(h[Qt]=o[Qt]),o[":@"]?ur(h,o[":@"],c,e):Object.keys(h).length===1&&h[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?h=h[e.textNodeName]:Object.keys(h).length===0&&(e.alwaysCreateTextNode?h[e.textNodeName]="":h=""),i[l]!==void 0&&i.hasOwnProperty(l)?(Array.isArray(i[l])||(i[l]=[i[l]]),i[l].push(h)):e.isArray(l,c,g)?i[l]=[h]:i[l]=h}}}return typeof n=="string"?n.length>0&&(i[e.textNodeName]=n):n!==void 0&&(i[e.textNodeName]=n),i}function cr(s){let e=Object.keys(s);for(let t=0;t<e.length;t++){let n=e[t];if(n!==":@")return n}}function ur(s,e,t,n){if(e){let i=Object.keys(e),r=i.length;for(let o=0;o<r;o++){let l=i[o];n.isArray(l,t+"."+l,!0,!0)?s[l]=[e[l]]:s[l]=e[l]}}}function hr(s,e){let{textNodeName:t}=e,n=Object.keys(s).length;return!!(n===0||n===1&&(s[t]||typeof s[t]=="boolean"||s[t]===0))}var wt=class{constructor(e){this.externalEntities={},this.options=de(e)}parse(e,t){if(typeof e!="string"&&e.toString)e=e.toString();else if(typeof e!="string")throw new Error("XML data is accepted in String or Bytes[] form.");if(t){t===!0&&(t={});let r=fe(e,t);if(r!==!0)throw Error(`${r.err.msg}:${r.err.line}:${r.err.col}`)}let n=new Tt(this.options);n.addExternalEntities(this.externalEntities);let i=n.parseXml(e);return this.options.preserveOrder||i===void 0?i:te(i,this.options)}addEntity(e,t){if(t.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(t==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}static getMetaDataSymbol(){return ft.getMetaDataSymbol()}};var Mt=class{constructor(){this.zip=null;this.xmlParser=new wt({ignoreAttributes:!1,attributeNamePrefix:"@_",textNodeName:"#text",preserveOrder:!0,trimValues:!1})}async parse(e){this.zip=await me.loadAsync(e);let[t,n,i,r,o]=await Promise.all([this.parseDocument(),this.parseImages(),this.parseStyles(),this.parseNumbering(),this.parseRelationships()]);return{document:t,images:n,styles:i,numbering:r,relationships:o}}async parseDocument(){let e=await this.getFileContent("word/document.xml");if(!e)throw new Error("document.xml not found in DOCX");let t=this.xmlParser.parse(e),n=this.extractBody(t);return{body:this.parseBodyElements(n)}}extractBody(e){for(let t of e)if(t["w:document"]){let n=t["w:document"];for(let i of n)if(i["w:body"])return i["w:body"]}return[]}parseBodyElements(e){if(!e||!Array.isArray(e))return[];let t=[];for(let n of e){let i=this.parseElement(n);i&&t.push(i)}return t}parseElement(e){return e["w:p"]?this.parseParagraph(e["w:p"]):e["w:tbl"]?this.parseTable(e["w:tbl"]):e["w:sdt"]?this.parseStructuredDocument(e["w:sdt"]):null}parseParagraph(e){let t=this.parseParagraphProperties(e),n=this.parseParagraphChildren(e);return t.headingLevel?{type:"heading",properties:t,children:n}:t.numId!==void 0?{type:"listItem",properties:t,children:n}:{type:"paragraph",properties:t,children:n}}parseParagraphProperties(e){let t={};for(let n of e)if(n["w:pPr"]){let i=n["w:pPr"];for(let r of i){if(r["w:pStyle"]){let o=r[":@"],l=o==null?void 0:o["@_w:val"];if(l){let c=l.match(/Heading(\d)/i);c&&(t.headingLevel=parseInt(c[1],10))}}if(r["w:numPr"]){let o=r["w:numPr"];for(let l of o){if(l["w:ilvl"]){let c=l[":@"];t.ilvl=parseInt((c==null?void 0:c["@_w:val"])||"0",10)}if(l["w:numId"]){let c=l[":@"];t.numId=parseInt((c==null?void 0:c["@_w:val"])||"0",10)}}}if(r["w:jc"]){let o=r[":@"],l=o==null?void 0:o["@_w:val"];(l==="center"||l==="right"||l==="left")&&(t.alignment=l)}}}return t}parseParagraphChildren(e){let t=[];for(let n of e)if(n["w:r"]){let i=this.parseRun(n["w:r"]);i&&t.push(i)}else if(n["w:hyperlink"]){let i=this.parseHyperlink(n);i&&t.push(i)}else if(n["m:oMathPara"]||n["m:oMath"]){let i=this.parseFormula(n);i&&t.push(i)}return t}parseRun(e){let t=this.parseRunProperties(e),n=[];for(let i of e)if(i["w:t"]){let r=this.extractText(i["w:t"]);n.push({type:"text",content:r})}else if(i["w:br"])n.push({type:"break"});else if(i["w:tab"])n.push({type:"tab"});else if(i["w:drawing"]){let r=this.parseDrawing(i["w:drawing"]);r&&n.push(r)}else if(i["m:oMath"]){let r=this.parseFormula(i);r&&n.push(r)}return n.length===0?null:{type:"run",properties:t,children:n}}extractText(e){return Array.isArray(e)?e.map(t=>this.extractText(t)).join(""):typeof e=="string"?e:e&&e["#text"]!==void 0?e["#text"]:""}parseRunProperties(e){let t={};for(let n of e)if(n["w:rPr"]){let i=n["w:rPr"];for(let r of i){if(r["w:b"]!==void 0){let o=r[":@"];t.bold=(o==null?void 0:o["@_w:val"])!=="false",(r["w:b"]===""||Array.isArray(r["w:b"]))&&(t.bold=!0)}if(r["w:i"]!==void 0){let o=r[":@"];t.italic=(o==null?void 0:o["@_w:val"])!=="false",(r["w:i"]===""||Array.isArray(r["w:i"]))&&(t.italic=!0)}if(r["w:u"]!==void 0&&(t.underline=!0),r["w:strike"]!==void 0&&(t.strikethrough=!0),r["w:vertAlign"]){let o=r[":@"],l=o==null?void 0:o["@_w:val"];l==="superscript"&&(t.superscript=!0),l==="subscript"&&(t.subscript=!0)}if(r["w:highlight"]){let o=r[":@"];t.highlight=o==null?void 0:o["@_w:val"]}if(r["w:color"]){let o=r[":@"];t.color=o==null?void 0:o["@_w:val"]}}}return t}parseHyperlink(e){let t=e[":@"],n=t==null?void 0:t["@_r:id"],i=e["w:hyperlink"],r=[];if(Array.isArray(i)){for(let o of i)if(o["w:r"]){let l=this.parseRun(o["w:r"]);l&&r.push(l)}}return{type:"hyperlink",properties:{hyperlinkUrl:n},children:r}}parseDrawing(e){let t=this.findBlipEmbed(e);return t?{type:"image",properties:{imageId:t}}:null}findBlipEmbed(e){if(!e)return null;if(Array.isArray(e))for(let t of e){let n=this.findBlipEmbed(t);if(n)return n}if(typeof e=="object"){if(e["a:blip"]!==void 0){let t=e[":@"];return(t==null?void 0:t["@_r:embed"])||null}for(let t of Object.keys(e))if(t!==":@"){let n=this.findBlipEmbed(e[t]);if(n)return n}}return null}parseFormula(e){return{type:"formula",properties:{omml:JSON.stringify(e)}}}parseTable(e){let t=[];for(let n of e)n["w:tr"]&&t.push(this.parseTableRow(n["w:tr"]));return{type:"table",children:t}}parseTableRow(e){let t=[];for(let n of e)n["w:tc"]&&t.push(this.parseTableCell(n["w:tc"]));return{type:"tableRow",children:t}}parseTableCell(e){let t=this.parseTableCellProperties(e),n=[];for(let i of e)if(i["w:p"]){let r=this.parseParagraph(i["w:p"]);r&&n.push(r)}return{type:"tableCell",properties:t,children:n}}parseTableCellProperties(e){let t={};for(let n of e)if(n["w:tcPr"]){let i=n["w:tcPr"];for(let r of i){if(r["w:gridSpan"]){let o=r[":@"];t.colspan=parseInt((o==null?void 0:o["@_w:val"])||"1",10)}if(r["w:vMerge"]){let o=r[":@"];(o==null?void 0:o["@_w:val"])==="restart"&&(t.rowspan=1)}}}return t}parseStructuredDocument(e){for(let t of e)if(t["w:sdtContent"]){let n=t["w:sdtContent"];for(let i of n){let r=this.parseElement(i);if(r)return r}}return null}async parseImages(){var n;let e=new Map;if(!this.zip)return e;let t=Object.keys(this.zip.files).filter(i=>i.startsWith("word/media/"));for(let i of t){let r=this.zip.file(i);if(!r)continue;let o=await r.async("arraybuffer"),l=i.split("/").pop()||"",c=((n=l.split(".").pop())==null?void 0:n.toLowerCase())||"",h=this.getImageContentType(c),g=i.replace("word/","");e.set(g,{data:o,contentType:h,fileName:l,extension:c})}return e}getImageContentType(e){return{png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",bmp:"image/bmp",svg:"image/svg+xml",webp:"image/webp",emf:"image/emf",wmf:"image/wmf"}[e]||"application/octet-stream"}async parseStyles(){let e=new Map,t=await this.getFileContent("word/styles.xml");if(!t)return e;let n=this.xmlParser.parse(t);for(let i of n)if(i["w:styles"]){let r=i["w:styles"];for(let o of r)if(o["w:style"]){let l=o[":@"],c=l==null?void 0:l["@_w:styleId"];c&&e.set(c,this.parseStyleDefinition(o,l))}}return e}parseStyleDefinition(e,t){let n=(t==null?void 0:t["@_w:styleId"])||"",i=(t==null?void 0:t["@_w:type"])||"",r="",o,l=e["w:style"];if(Array.isArray(l))for(let c of l){if(c["w:name"]){let h=c[":@"];r=(h==null?void 0:h["@_w:val"])||""}if(c["w:basedOn"]){let h=c[":@"];o=h==null?void 0:h["@_w:val"]}}return{styleId:n,name:r,type:i,basedOn:o,properties:{}}}async parseNumbering(){let e=await this.getFileContent("word/numbering.xml");if(!e)return null;let t=this.xmlParser.parse(e),n=new Map,i=new Map;for(let r of t)if(r["w:numbering"]){let o=r["w:numbering"];for(let l of o){if(l["w:abstractNum"]){let c=l[":@"],h=this.parseAbstractNum(l["w:abstractNum"],c);n.set(h.abstractNumId,h)}if(l["w:num"]){let c=l[":@"],h=this.parseNumInstance(l["w:num"],c);i.set(h.numId,h)}}}return{abstractNums:n,nums:i}}parseAbstractNum(e,t){let n=parseInt((t==null?void 0:t["@_w:abstractNumId"])||"0",10),i=new Map;for(let r of e)if(r["w:lvl"]){let o=r[":@"],l=this.parseNumberingLevel(r["w:lvl"],o);i.set(l.ilvl,l)}return{abstractNumId:n,levels:i}}parseNumberingLevel(e,t){let n=parseInt((t==null?void 0:t["@_w:ilvl"])||"0",10),i="decimal",r="%1.",o=1;for(let l of e){if(l["w:numFmt"]){let c=l[":@"];i=(c==null?void 0:c["@_w:val"])||"decimal"}if(l["w:lvlText"]){let c=l[":@"];r=(c==null?void 0:c["@_w:val"])||""}if(l["w:start"]){let c=l[":@"];o=parseInt((c==null?void 0:c["@_w:val"])||"1",10)}}return{ilvl:n,numFmt:i,lvlText:r,start:o}}parseNumInstance(e,t){let n=parseInt((t==null?void 0:t["@_w:numId"])||"0",10),i=0;for(let r of e)if(r["w:abstractNumId"]){let o=r[":@"];i=parseInt((o==null?void 0:o["@_w:val"])||"0",10)}return{numId:n,abstractNumId:i}}async parseRelationships(){let e=new Map,t=await this.getFileContent("word/_rels/document.xml.rels");if(!t)return e;let n=this.xmlParser.parse(t);for(let i of n)if(i.Relationships){let r=i.Relationships;for(let o of r)if(o.Relationship){let l=o[":@"],c=l==null?void 0:l["@_Id"],h=l==null?void 0:l["@_Type"],g=l==null?void 0:l["@_Target"];c&&e.set(c,{id:c,type:h,target:g})}}return e}async getFileContent(e){if(!this.zip)return null;let t=this.zip.file(e);return t?await t.async("string"):null}};var $t=class{constructor(){this.xmlParser=new wt({ignoreAttributes:!1,attributeNamePrefix:"@_",textNodeName:"#text",preserveOrder:!0,trimValues:!1})}parse(e){try{let t=JSON.parse(e);return this.parseNode(t)}catch(t){return console.error("OMML parse error:",t),{type:"unknown",tagName:"",children:[],text:null,attributes:{}}}}parseNode(e){if(Array.isArray(e))return{type:"math",tagName:"m:oMath",children:e.map(c=>this.parseNode(c)),text:null,attributes:{}};let t="",n=null,i={};for(let l of Object.keys(e))if(l===":@")for(let c of Object.keys(e[l])){let h=c.replace("@_","");i[h]=e[l][c]}else l==="#text"||(t=l),n=e[l];let r=[],o=null;if(typeof n=="string")o=n;else if(Array.isArray(n))for(let l of n)r.push(this.parseNode(l));else n&&typeof n=="object"&&r.push(this.parseNode(n));return{type:this.getElementType(t),tagName:t,children:r,text:o,attributes:i}}getElementType(e){return{"m:oMath":"math","m:oMathPara":"mathPara","m:r":"run","m:t":"text","m:f":"fraction","m:num":"numerator","m:den":"denominator","m:rad":"radical","m:deg":"degree","m:e":"element","m:sup":"superscript","m:sub":"subscript","m:sSup":"superscriptContainer","m:sSub":"subscriptContainer","m:sSubSup":"subSupContainer","m:nary":"nary","m:limLow":"limitLow","m:limUpp":"limitUpper","m:lim":"limit","m:m":"matrix","m:mr":"matrixRow","m:d":"delimiter","m:dPr":"delimiterProps","m:begChr":"beginChar","m:endChr":"endChar","m:func":"function","m:fName":"functionName","m:eqArr":"equationArray","m:acc":"accent","m:accPr":"accentProps","m:chr":"character","m:bar":"bar","m:box":"box","m:groupChr":"groupChar","m:borderBox":"borderBox","m:sPre":"preSuperSubscript","m:naryPr":"naryProps","m:ctrlPr":"controlProps","m:rPr":"runProps","":"unknown"}[e]||"unknown"}};var Ut=class{constructor(){this.unicodeToLatex=new Map([["\u03B1","\\alpha"],["\u03B2","\\beta"],["\u03B3","\\gamma"],["\u03B4","\\delta"],["\u03B5","\\epsilon"],["\u03B6","\\zeta"],["\u03B7","\\eta"],["\u03B8","\\theta"],["\u03B9","\\iota"],["\u03BA","\\kappa"],["\u03BB","\\lambda"],["\u03BC","\\mu"],["\u03BD","\\nu"],["\u03BE","\\xi"],["\u03C0","\\pi"],["\u03C1","\\rho"],["\u03C3","\\sigma"],["\u03C4","\\tau"],["\u03C5","\\upsilon"],["\u03C6","\\phi"],["\u03C7","\\chi"],["\u03C8","\\psi"],["\u03C9","\\omega"],["\u0393","\\Gamma"],["\u0394","\\Delta"],["\u0398","\\Theta"],["\u039B","\\Lambda"],["\u039E","\\Xi"],["\u03A0","\\Pi"],["\u03A3","\\Sigma"],["\u03A5","\\Upsilon"],["\u03A6","\\Phi"],["\u03A8","\\Psi"],["\u03A9","\\Omega"],["\xD7","\\times"],["\xF7","\\div"],["\xB1","\\pm"],["\u2213","\\mp"],["\xB7","\\cdot"],["\xB0","^\\circ"],["\u221E","\\infty"],["\u2248","\\approx"],["\u2260","\\neq"],["\u2264","\\leq"],["\u2265","\\geq"],["\u226A","\\ll"],["\u226B","\\gg"],["\u221D","\\propto"],["\u2261","\\equiv"],["\u223C","\\sim"],["\u2243","\\simeq"],["\u2245","\\cong"],["\u2208","\\in"],["\u2209","\\notin"],["\u2282","\\subset"],["\u2283","\\supset"],["\u2286","\\subseteq"],["\u2287","\\supseteq"],["\u222A","\\cup"],["\u2229","\\cap"],["\u2205","\\emptyset"],["\u2200","\\forall"],["\u2203","\\exists"],["\u2204","\\nexists"],["\u2192","\\rightarrow"],["\u2190","\\leftarrow"],["\u2194","\\leftrightarrow"],["\u21D2","\\Rightarrow"],["\u21D0","\\Leftarrow"],["\u21D4","\\Leftrightarrow"],["\u2191","\\uparrow"],["\u2193","\\downarrow"],["\u21A6","\\mapsto"],["\u2202","\\partial"],["\u2207","\\nabla"],["\u222B","\\int"],["\u222C","\\iint"],["\u222D","\\iiint"],["\u222E","\\oint"],["\u2211","\\sum"],["\u220F","\\prod"],["\u221A","\\sqrt"],["\u2227","\\land"],["\u2228","\\lor"],["\xAC","\\neg"],["\u2295","\\oplus"],["\u2297","\\otimes"],["\u22A5","\\perp"],["\u2225","\\parallel"],["\u2115","\\mathbb{N}"],["\u2124","\\mathbb{Z}"],["\u211A","\\mathbb{Q}"],["\u211D","\\mathbb{R}"],["\u2102","\\mathbb{C}"],["\u210F","\\hbar"],["\u2113","\\ell"],["\u2032","'"],["\u2033","''"]]);this.functionNames=new Map([["sin","\\sin"],["cos","\\cos"],["tan","\\tan"],["cot","\\cot"],["sec","\\sec"],["csc","\\csc"],["arcsin","\\arcsin"],["arccos","\\arccos"],["arctan","\\arctan"],["sinh","\\sinh"],["cosh","\\cosh"],["tanh","\\tanh"],["log","\\log"],["ln","\\ln"],["exp","\\exp"],["lim","\\lim"],["max","\\max"],["min","\\min"],["sup","\\sup"],["inf","\\inf"],["det","\\det"],["dim","\\dim"],["ker","\\ker"],["gcd","\\gcd"],["mod","\\mod"],["arg","\\arg"],["deg","\\deg"]]);this.accentMap=new Map([["\u0302","\\hat"],["\u0303","\\tilde"],["\u0304","\\bar"],["\u20D7","\\vec"],["\u0307","\\dot"],["\u0308","\\ddot"],["\u0306","\\breve"],["\u030C","\\check"],["\u02C6","\\hat"],["\u02DC","\\tilde"],["\xAF","\\bar"],["\u2192","\\vec"]]);this.parser=new $t}convert(e){try{let t=this.parser.parse(e),n=this.elementToLatex(t);return this.cleanupLatex(n)}catch(t){return console.error("Formula conversion error:",t),"[Formula conversion error]"}}elementToLatex(e){switch(e.type){case"math":case"mathPara":return this.convertMath(e);case"run":return this.convertRun(e);case"text":return this.convertText(e);case"fraction":return this.convertFraction(e);case"radical":return this.convertRadical(e);case"superscriptContainer":return this.convertSuperscript(e);case"subscriptContainer":return this.convertSubscript(e);case"subSupContainer":return this.convertSubSup(e);case"nary":return this.convertNary(e);case"limitLow":return this.convertLimitLow(e);case"limitUpper":return this.convertLimitUpper(e);case"matrix":return this.convertMatrix(e);case"delimiter":return this.convertDelimiter(e);case"function":return this.convertFunction(e);case"equationArray":return this.convertEquationArray(e);case"accent":return this.convertAccent(e);case"bar":return this.convertBar(e);case"box":return this.convertBox(e);case"groupChar":return this.convertGroupChar(e);case"borderBox":return this.convertBorderBox(e);case"preSuperSubscript":return this.convertPreSuperSubscript(e);case"element":case"numerator":case"denominator":case"degree":case"superscript":case"subscript":case"limit":case"matrixRow":case"functionName":return this.convertChildren(e);case"naryProps":case"delimiterProps":case"accentProps":case"controlProps":case"runProps":return"";default:return this.convertChildren(e)}}convertMath(e){return this.convertChildren(e)}convertRun(e){return this.convertChildren(e)}isLetter(e){return/^[a-zA-Z]$/.test(e)}isDigit(e){return/^[0-9]$/.test(e)}isAlphanumeric(e){return this.isLetter(e)||this.isDigit(e)}endsWithLatexCommand(e){return e.match(/\\[a-zA-Z]+$/)!==null}needsSpaceBefore(e,t){return e?!!(this.isAlphanumeric(t)&&this.endsWithLatexCommand(e)):!1}convertText(e){let t=e.text||"";for(let n of e.children)n.text?t+=n.text:n.type==="text"&&(t+=this.convertText(n));return this.convertTextContent(t)}convertFraction(e){let t="",n="";for(let i of e.children)i.type==="numerator"||i.tagName==="m:num"?t=this.convertChildren(i):(i.type==="denominator"||i.tagName==="m:den")&&(n=this.convertChildren(i));return(t.includes("+")||t.includes("-")||t.includes("*"))&&(t=`{${t}}`),(n.includes("+")||n.includes("-")||n.includes("*"))&&(n=`{${n}}`),`\\frac{${t}}{${n}}`}convertRadical(e){let t="",n="";for(let i of e.children)i.type==="degree"||i.tagName==="m:deg"?t=this.convertChildren(i):(i.type==="element"||i.tagName==="m:e")&&(n=this.convertChildren(i));return t&&t.trim()!==""&&t.trim()!=="2"?`\\sqrt[${t}]{${n}}`:`\\sqrt{${n}}`}convertSuperscript(e){let t="",n="";for(let i of e.children)i.type==="element"||i.tagName==="m:e"?t=this.convertChildren(i):(i.type==="superscript"||i.tagName==="m:sup")&&(n=this.convertChildren(i));return`${t}^{${n}}`}convertSubscript(e){let t="",n="";for(let i of e.children)i.type==="element"||i.tagName==="m:e"?t=this.convertChildren(i):(i.type==="subscript"||i.tagName==="m:sub")&&(n=this.convertChildren(i));return`${t}_{${n}}`}convertSubSup(e){let t="",n="",i="";for(let r of e.children)r.type==="element"||r.tagName==="m:e"?t=this.convertChildren(r):r.type==="subscript"||r.tagName==="m:sub"?n=this.convertChildren(r):(r.type==="superscript"||r.tagName==="m:sup")&&(i=this.convertChildren(r));return`${t}_{${n}}^{${i}}`}convertNary(e){let t="\\int",n="",i="",r="";for(let l of e.children)if(l.type==="naryProps"||l.tagName==="m:naryPr"){for(let c of l.children)if(c.tagName==="m:chr"||c.type==="character"){let h=c.attributes["m:val"]||c.attributes.val;h&&(t=this.convertNaryChar(h))}}else l.type==="subscript"||l.tagName==="m:sub"?n=this.convertChildren(l):l.type==="superscript"||l.tagName==="m:sup"?i=this.convertChildren(l):(l.type==="element"||l.tagName==="m:e")&&(r=this.convertChildren(l));let o=t;return n&&(o+=`_{${n}}`),i&&(o+=`^{${i}}`),r&&(o+=` ${r}`),o}convertNaryChar(e){return{"\u222B":"\\int","\u222C":"\\iint","\u222D":"\\iiint","\u222E":"\\oint","\u2211":"\\sum","\u220F":"\\prod","\u22C3":"\\bigcup","\u22C2":"\\bigcap","\u22C1":"\\bigvee","\u22C0":"\\bigwedge"}[e]||"\\int"}convertLimitLow(e){let t="",n="";for(let i of e.children)i.type==="element"||i.tagName==="m:e"?t=this.convertChildren(i):(i.type==="limit"||i.tagName==="m:lim")&&(n=this.convertChildren(i));return`${t}_{${n}}`}convertLimitUpper(e){let t="",n="";for(let i of e.children)i.type==="element"||i.tagName==="m:e"?t=this.convertChildren(i):(i.type==="limit"||i.tagName==="m:lim")&&(n=this.convertChildren(i));return`${t}^{${n}}`}convertMatrix(e){let t=[];for(let n of e.children)if(n.type==="matrixRow"||n.tagName==="m:mr"){let i=[];for(let r of n.children)(r.type==="element"||r.tagName==="m:e")&&i.push(this.convertChildren(r));t.push(i.join(" & "))}return`\\begin{pmatrix} ${t.join(" \\\\ ")} \\end{pmatrix}`}convertDelimiter(e){let t="(",n=")",i=[];for(let l of e.children)if(l.type==="delimiterProps"||l.tagName==="m:dPr")for(let c of l.children)(c.tagName==="m:begChr"||c.type==="beginChar")&&(t=c.attributes["m:val"]||c.attributes.val||"("),(c.tagName==="m:endChr"||c.type==="endChar")&&(n=c.attributes["m:val"]||c.attributes.val||")");else(l.type==="element"||l.tagName==="m:e")&&i.push(this.convertChildren(l));let r=this.convertDelimiterChar(t),o=this.convertDelimiterChar(n);return`\\left${r} ${i.join(", ")} \\right${o}`}convertDelimiterChar(e){return{"(":"(",")":")","[":"[","]":"]","{":"\\{","}":"\\}","|":"|","\u2016":"\\|","\u2308":"\\lceil","\u2309":"\\rceil","\u230A":"\\lfloor","\u230B":"\\rfloor","\u27E8":"\\langle","\u27E9":"\\rangle","":"."}[e]||e}convertFunction(e){let t="",n="";for(let i of e.children)i.type==="functionName"||i.tagName==="m:fName"?t=this.convertChildren(i).trim():(i.type==="element"||i.tagName==="m:e")&&(n=this.convertChildren(i));return this.functionNames.has(t)?`${this.functionNames.get(t)} ${n}`:`\\operatorname{${t}} ${n}`}convertEquationArray(e){let t=[];for(let n of e.children)(n.type==="element"||n.tagName==="m:e")&&t.push(this.convertChildren(n));return t.length===1?t[0]:`\\begin{aligned} ${t.join(" \\\\ ")} \\end{aligned}`}convertAccent(e){let t="^",n="";for(let r of e.children)if(r.type==="accentProps"||r.tagName==="m:accPr")for(let o of r.children)(o.tagName==="m:chr"||o.type==="character")&&(t=o.attributes["m:val"]||o.attributes.val||"^");else(r.type==="element"||r.tagName==="m:e")&&(n=this.convertChildren(r));return`${this.accentMap.get(t)||"\\hat"}{${n}}`}convertBar(e){let t="";for(let n of e.children)(n.type==="element"||n.tagName==="m:e")&&(t=this.convertChildren(n));return`\\overline{${t}}`}convertBox(e){return this.convertChildren(e)}convertGroupChar(e){let t="",n="";for(let i of e.children)if(i.tagName==="m:groupChrPr")for(let r of i.children)r.tagName==="m:chr"&&(n=r.attributes["m:val"]||r.attributes.val||"");else(i.type==="element"||i.tagName==="m:e")&&(t=this.convertChildren(i));return n==="\u23DF"||n==="\uFE38"?`\\underbrace{${t}}`:n==="\u23DE"||n==="\uFE37"?`\\overbrace{${t}}`:t}convertBorderBox(e){let t="";for(let n of e.children)(n.type==="element"||n.tagName==="m:e")&&(t=this.convertChildren(n));return`\\boxed{${t}}`}convertPreSuperSubscript(e){let t="",n="",i="";for(let r of e.children)r.type==="element"||r.tagName==="m:e"?t=this.convertChildren(r):r.type==="subscript"||r.tagName==="m:sub"?n=this.convertChildren(r):(r.type==="superscript"||r.tagName==="m:sup")&&(i=this.convertChildren(r));return`{}_{${n}}^{${i}}${t}`}convertChildren(e){if(e.text)return this.convertTextContent(e.text);let t=[];for(let i of e.children){let r=this.elementToLatex(i);r&&t.push(r)}let n="";for(let i=0;i<t.length;i++){let r=t[i];if(i===0)n=r;else{let o=r.charAt(0);this.needsSpaceBefore(n,o)?n+=" "+r:n+=r}}return n}convertTextContent(e){e=e.replace(/\u00A0/g," ");let t="",n=Array.from(e);for(let i=0;i<n.length;i++){let r=n[i],o=i+1<n.length?n[i+1]:null;if(this.unicodeToLatex.has(r)){let l=this.unicodeToLatex.get(r);t&&this.isAlphanumeric(t.charAt(t.length-1))&&(t+=" "),t+=l,o&&this.isAlphanumeric(o)&&!l.endsWith("}")&&(t+=" ")}else r===" "?t&&!t.endsWith(" ")&&!t.endsWith("{")&&(t+=" "):["+","-","="].includes(r)?(t&&!t.endsWith(" ")&&(t+=" "),t+=r,o&&o!==" "&&(t+=" ")):(this.isAlphanumeric(r)&&this.endsWithLatexCommand(t)&&(t+=" "),t+=r)}return t}cleanupLatex(e){return e.replace(/\u00A0/g," ").replace(/\s*([+\-=])\s*/g," $1 ").replace(/\s{2,}/g," ").replace(/\{\s+/g,"{").replace(/\s+\}/g,"}").replace(/\}\s+_/g,"}_").replace(/\}\s+\^/g,"}^").replace(/([^\\a-zA-Z])\s+_/g,"$1_").replace(/([^\\a-zA-Z])\s+\^/g,"$1^").replace(/_\s+\{/g,"_{").replace(/\^\s+\{/g,"^{").trim()}};var jt=class{constructor(e){this.vault=e}async saveImage(e,t){let n=t.relationships.get(e);if(!n)return console.warn(`No relationship found for image: ${e}`),null;let i=n.target.replace("../",""),r=t.images.get(i);if(!r)return console.warn(`No image data found for: ${i}`),null;let o=t.settings.imageFolder;t.settings.createImageFolder&&await this.ensureFolderExists(o);let l=await this.generateUniqueFileName(o,r.fileName),c=`${o}/${l}`;return await this.vault.createBinary(c,r.data),t.settings.useRelativeImagePaths?`![[${l}]]`:`![[${c}]]`}async ensureFolderExists(e){this.vault.getAbstractFileByPath(e)||await this.vault.createFolder(e)}async generateUniqueFileName(e,t){let n=t.replace(/\.[^.]+$/,""),i=t.split(".").pop()||"png",r=`${n}.${i}`,o=1;for(;this.vault.getAbstractFileByPath(`${e}/${r}`);)r=`${n}_${o}.${i}`,o++;return r}getImageMarkdown(e,t){return t?`![[${e}|${t}]]`:`![[${e}]]`}};var Dt=class{constructor(e,t){this.formulaConverter=e,this.imageConverter=t}async convert(e,t){var o;let n=e.children||[];if(n.length===0)return"";let i=[],r=0;for(let l of n){let c=l.children||[],h=[];for(let g of c){let f=await this.convertCellContent(g,t),b=((o=g.properties)==null?void 0:o.colspan)||1;h.push(f);for(let d=1;d<b;d++)h.push("")}i.push(h),r=Math.max(r,h.length)}for(let l of i)for(;l.length<r;)l.push("");return this.buildMarkdownTable(i,t)}async convertCellContent(e,t){let n=e.children||[],i=[];for(let r of n){let o=await this.convertParagraphInCell(r,t);o.trim()&&i.push(o.trim())}return i.join("<br>")}async convertParagraphInCell(e,t){var r,o;let n=e.children||[],i="";for(let l of n)if(l.type==="formula"){let c=this.formulaConverter.convert(((r=l.properties)==null?void 0:r.omml)||"");i+=`$${c}$`}else if(l.type==="image"){let c=await this.imageConverter.saveImage(((o=l.properties)==null?void 0:o.imageId)||"",t);c&&(i+=c)}else l.type==="run"&&(i+=await this.convertRunContent(l,t));return i}async convertRunContent(e,t){var l,c;let n=e.children||[],i=[];for(let h of n)if(h.type==="text")i.push(h.content||"");else if(h.type==="break")i.push("<br>");else if(h.type==="tab")i.push("    ");else if(h.type==="image"){let g=await this.imageConverter.saveImage(((l=h.properties)==null?void 0:l.imageId)||"",t);g&&i.push(g)}else if(h.type==="formula"){let g=this.formulaConverter.convert(((c=h.properties)==null?void 0:c.omml)||"");i.push(`$${g}$`)}let r=i.join(""),o=e.properties||{};return o.bold&&o.italic?r=`***${r}***`:o.bold?r=`**${r}**`:o.italic&&(r=`*${r}*`),o.strikethrough&&(r=`~~${r}~~`),o.highlight&&(r=`==${r}==`),r}buildMarkdownTable(e,t){if(e.length===0)return"";let n=[],i=e[0].length;n.push("| "+e[0].map(l=>this.escapeCell(l)).join(" | ")+" |");let r=t.settings.tableAlignment,o;switch(r){case"center":o=":---:";break;case"right":o="---:";break;default:o="---"}n.push("| "+Array(i).fill(o).join(" | ")+" |");for(let l=1;l<e.length;l++)n.push("| "+e[l].map(c=>this.escapeCell(c)).join(" | ")+" |");return n.join(`
`)}escapeCell(e){return e.replace(/\|/g,"\\|").replace(/\n/g,"<br>")}};var Wt=class{convert(e,t){let n=[],i=this.getCounterKey(e);t.listCounters.has(i)||t.listCounters.set(i,[]);for(let r of e){let o=this.convertItem(r,t);o&&n.push(o)}return n.join(`
`)}convertItem(e,t){var g;let n=e.properties||{},i=n.numId,r=(g=n.ilvl)!=null?g:0,o=this.getListInfo(i,r,t),l="  ".repeat(r),c;o.isBullet?c="- ":c=`${this.getListCounter(i,r,t)}. `;let h=this.convertItemContent(e,t);return`${l}${c}${h}`}getListInfo(e,t,n){if(e===void 0||!n.numbering)return{isBullet:!0,level:null};let i=n.numbering.nums.get(e);if(!i)return{isBullet:!0,level:null};let r=n.numbering.abstractNums.get(i.abstractNumId);if(!r)return{isBullet:!0,level:null};let o=r.levels.get(t);return o?{isBullet:this.isBulletFormat(o.numFmt),level:o}:{isBullet:!0,level:null}}isBulletFormat(e){return["bullet","none"].includes(e.toLowerCase())}getListCounter(e,t,n){if(e===void 0)return 1;let i=`${e}`,r=n.listCounters.get(i);for(r||(r=[],n.listCounters.set(i,r));r.length<=t;)r.push(0);r[t]++;for(let o=t+1;o<r.length;o++)r[o]=0;return r[t]}convertItemContent(e,t){let n=e.children||[],i="";for(let r of n)r.type==="run"?i+=this.convertRun(r):r.type==="hyperlink"&&(i+=this.convertHyperlink(r,t));return i.trim()}convertRun(e){let t=e.children||[],n="";for(let r of t)r.type==="text"&&(n+=r.content||"");let i=e.properties||{};return i.bold&&i.italic?n=`***${n}***`:i.bold?n=`**${n}**`:i.italic&&(n=`*${n}*`),i.strikethrough&&(n=`~~${n}~~`),n}convertHyperlink(e,t){var l;let n=(l=e.properties)==null?void 0:l.hyperlinkUrl,i=n?t.relationships.get(n):null,r=(i==null?void 0:i.target)||"#",o="";for(let c of e.children||[])o+=this.convertRun(c);return`[${o}](${r})`}getCounterKey(e){var n;let t=e[0];return((n=t==null?void 0:t.properties)==null?void 0:n.numId)!==void 0?`list_${t.properties.numId}`:"default_list"}resetCounters(e){e.listCounters.clear()}};var Ot=class{constructor(e,t){this.settings=e,this.vault=t,this.formulaConverter=new Ut,this.imageConverter=new jt(t),this.tableConverter=new Dt(this.formulaConverter,this.imageConverter),this.listConverter=new Wt}async convert(e,t){let n={settings:this.settings,images:e.images,styles:e.styles,numbering:e.numbering,relationships:e.relationships,listCounters:new Map,currentPath:t},i=[],r=[],o=this.groupListItems(e.document.body);for(let l of o)try{let c=await this.convertElement(l,n);c.trim()&&r.push(c)}catch(c){console.error("Conversion error:",c),i.push(`Failed to convert element: ${Array.isArray(l)?"list":l.type}`)}return{markdown:r.join(`

`),images:new Map,warnings:i}}groupListItems(e){var r;let t=[],n=[],i=null;for(let o of e)if(o.type==="listItem"){let l=(r=o.properties)==null?void 0:r.numId;n.length===0||l===i?(n.push(o),i=l!=null?l:null):(n.length>0&&t.push(n),n=[o],i=l!=null?l:null)}else n.length>0&&(t.push(n),n=[],i=null),t.push(o);return n.length>0&&t.push(n),t}async convertElement(e,t){if(Array.isArray(e))return this.listConverter.convert(e,t);switch(e.type){case"heading":return this.convertHeading(e,t);case"paragraph":return this.convertParagraph(e,t);case"table":return this.tableConverter.convert(e,t);case"listItem":return this.listConverter.convertItem(e,t);default:return""}}async convertHeading(e,t){var o;let n=((o=e.properties)==null?void 0:o.headingLevel)||1,i="#".repeat(Math.min(n,6))+" ",r=await this.convertParagraphContent(e,t);return i+r}async convertParagraph(e,t){var r;let n=await this.convertParagraphContent(e,t),i=(r=e.properties)==null?void 0:r.alignment;return i==="center"?`<center>${n}</center>`:i==="right"?`<div style="text-align: right">${n}</div>`:n}async convertParagraphContent(e,t){let n=e.children||[],i=[];for(let r of n){let o=await this.convertInlineElement(r,t);i.push(o)}return i.join("")}async convertInlineElement(e,t){switch(e.type){case"run":return this.convertRun(e,t);case"hyperlink":return this.convertHyperlink(e,t);case"formula":return this.convertFormula(e,t);case"image":return this.convertImage(e,t);case"break":return t.settings.preserveLineBreaks?`
`:" ";case"tab":return"    ";default:return""}}async convertRun(e,t){let n=e.children||[],i=[];for(let o of n)switch(o.type){case"text":i.push(o.content||"");break;case"break":i.push(t.settings.preserveLineBreaks?`
`:" ");break;case"tab":i.push("    ");break;case"image":let l=await this.convertImage(o,t);i.push(l);break;case"formula":let c=this.convertFormula(o,t);i.push(c);break}let r=i.join("");return r=this.applyFormatting(r,e.properties||{}),r}applyFormatting(e,t){var o,l;if(!t||!e.trim())return e;let n=((o=e.match(/^\s*/))==null?void 0:o[0])||"",i=((l=e.match(/\s*$/))==null?void 0:l[0])||"",r=e.trim();return r?(t.strikethrough&&(r=`~~${r}~~`),t.bold&&t.italic?r=`***${r}***`:t.bold?r=`**${r}**`:t.italic&&(r=`*${r}*`),t.highlight&&(r=`==${r}==`),t.superscript&&(r=`<sup>${r}</sup>`),t.subscript&&(r=`<sub>${r}</sub>`),t.underline&&(r=`<u>${r}</u>`),n+r+i):e}async convertHyperlink(e,t){var c;let n=(c=e.properties)==null?void 0:c.hyperlinkUrl,i="#";if(n){let h=t.relationships.get(n);h&&(i=h.target)}let r=e.children||[],o=[];for(let h of r)if(h.type==="run"){let g=h.children||[];for(let f of g)f.type==="text"&&o.push(f.content||"")}let l=o.join("");return i.startsWith("#")?`[[${i.substring(1)}|${l}]]`:`[${l}](${i})`}convertFormula(e,t){var i;let n=(i=e.properties)==null?void 0:i.omml;if(!n)return"";try{let r=this.formulaConverter.convert(n);return t.settings.formulaFormat==="latex"?`$${r}$`:`$${r}$`}catch(r){return console.error("Formula conversion error:",r),"[Formula]"}}async convertImage(e,t){var i;let n=(i=e.properties)==null?void 0:i.imageId;if(!n)return"";try{return await this.imageConverter.saveImage(n,t)||"[Image]"}catch(r){return console.error("Image conversion error:",r),"[Image]"}}convertBlockFormula(e){try{return`$$
${this.formulaConverter.convert(e)}
$$`}catch(t){return console.error("Block formula conversion error:",t),"$$[Formula]$$"}}updateSettings(e){this.settings=e}};var bt=require("obsidian"),Zt=class extends bt.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"DOCX Importer Settings"}),e.createEl("h3",{text:"Image Settings"}),new bt.Setting(e).setName("Image folder").setDesc("Folder where imported images will be saved").addText(t=>t.setPlaceholder("attachments").setValue(this.plugin.settings.imageFolder).onChange(async n=>{this.plugin.settings.imageFolder=n||"attachments",await this.plugin.saveSettings()})),new bt.Setting(e).setName("Create image folder").setDesc("Automatically create the image folder if it does not exist").addToggle(t=>t.setValue(this.plugin.settings.createImageFolder).onChange(async n=>{this.plugin.settings.createImageFolder=n,await this.plugin.saveSettings()})),new bt.Setting(e).setName("Use relative image paths").setDesc("Use relative paths for image references (recommended for portability)").addToggle(t=>t.setValue(this.plugin.settings.useRelativeImagePaths).onChange(async n=>{this.plugin.settings.useRelativeImagePaths=n,await this.plugin.saveSettings()})),e.createEl("h3",{text:"Formula Settings"}),new bt.Setting(e).setName("Formula format").setDesc("Output format for mathematical formulas").addDropdown(t=>t.addOption("latex","LaTeX").addOption("mathml","MathML").setValue(this.plugin.settings.formulaFormat).onChange(async n=>{this.plugin.settings.formulaFormat=n,await this.plugin.saveSettings()})),e.createEl("h3",{text:"Table Settings"}),new bt.Setting(e).setName("Default table alignment").setDesc("Default alignment for table columns").addDropdown(t=>t.addOption("left","Left").addOption("center","Center").addOption("right","Right").setValue(this.plugin.settings.tableAlignment).onChange(async n=>{this.plugin.settings.tableAlignment=n,await this.plugin.saveSettings()})),e.createEl("h3",{text:"Formatting Settings"}),new bt.Setting(e).setName("Preserve line breaks").setDesc("Keep line breaks from the original document").addToggle(t=>t.setValue(this.plugin.settings.preserveLineBreaks).onChange(async n=>{this.plugin.settings.preserveLineBreaks=n,await this.plugin.saveSettings()})),new bt.Setting(e).setName("Handle list numbering").setDesc("Properly handle numbered and bulleted lists").addToggle(t=>t.setValue(this.plugin.settings.handleNumbering).onChange(async n=>{this.plugin.settings.handleNumbering=n,await this.plugin.saveSettings()}))}};var ht=require("obsidian"),Pt=class extends ht.Modal{constructor(t,n){super(t);this.file=null;this.outputFileName="";this.plugin=n}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:"Import DOCX File"}),new ht.Setting(t).setName("Select DOCX file").setDesc("Choose a .docx file to import").addButton(r=>r.setButtonText("Choose File").onClick(()=>{let o=document.createElement("input");o.type="file",o.accept=".docx",o.onchange=l=>{let c=l.target;c.files&&c.files.length>0&&(this.file=c.files[0],this.outputFileName=this.file.name.replace(".docx",""),n.setText(`Selected: ${this.file.name}`),i.setValue(this.outputFileName))},o.click()}));let n=t.createEl("p",{text:"No file selected",cls:"docx-importer-file-display"}),i;new ht.Setting(t).setName("Output file name").setDesc("Name for the created markdown file (without extension)").addText(r=>{i=r,r.setPlaceholder("output").setValue(this.outputFileName).onChange(o=>{this.outputFileName=o})}),new ht.Setting(t).addButton(r=>r.setButtonText("Import").setCta().onClick(async()=>{if(!this.file){new ht.Notice("Please select a DOCX file first");return}if(!this.outputFileName){new ht.Notice("Please enter an output file name");return}await this.importFile()})),new ht.Setting(t).addButton(r=>r.setButtonText("Cancel").onClick(()=>{this.close()}))}async importFile(){if(this.file)try{new ht.Notice("Importing DOCX file...");let t=await this.file.arrayBuffer(),n=await this.plugin.importDocx(t,this.outputFileName);n.warnings.length>0?(console.warn("Import warnings:",n.warnings),new ht.Notice(`Import completed with ${n.warnings.length} warning(s). Check console for details.`)):new ht.Notice("DOCX file imported successfully!"),this.close()}catch(t){console.error("Import error:",t),new ht.Notice(`Import failed: ${t instanceof Error?t.message:"Unknown error"}`)}}onClose(){let{contentEl:t}=this;t.empty()}};function ge(s){return s.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g," ").trim()}function ve(s){return s.split(`
`).map(e=>e.trimEnd()).join(`
`)}function be(s){return s.replace(/\r\n/g,`
`).replace(/\r/g,`
`).replace(/\n{3,}/g,`

`)}var Vt=class extends mt.Plugin{constructor(){super(...arguments);this.settings=Ht;this.converter=null}async onload(){console.log("Loading DOCX Importer plugin"),await this.loadSettings(),this.parser=new Mt,this.converter=new Ot(this.settings,this.app.vault),this.addRibbonIcon("file-input","Import DOCX",()=>{new Pt(this.app,this).open()}),this.addCommand({id:"import-docx",name:"Import DOCX file",callback:()=>{new Pt(this.app,this).open()}}),this.addCommand({id:"import-docx-from-clipboard",name:"Import DOCX from file path in clipboard",callback:async()=>{try{(await navigator.clipboard.readText()).endsWith(".docx")&&new mt.Notice("Please use the Import DOCX command and select a file")}catch(t){new mt.Notice("Could not read clipboard")}}}),this.registerEvent(this.app.workspace.on("file-menu",(t,n)=>{n instanceof mt.TFile&&n.extension==="docx"&&t.addItem(i=>{i.setTitle("Convert to Markdown").setIcon("file-text").onClick(async()=>{await this.convertDocxInVault(n)})})})),this.registerDomEvent(document,"drop",async t=>{var i;let n=(i=t.dataTransfer)==null?void 0:i.files;if(n&&n.length>0)for(let r=0;r<n.length;r++){let o=n[r];if(o.name.endsWith(".docx")){t.preventDefault();let l=await o.arrayBuffer(),c=o.name.replace(".docx","");await this.importDocx(l,c)}}}),this.addSettingTab(new Zt(this.app,this)),console.log("DOCX Importer plugin loaded")}onunload(){console.log("Unloading DOCX Importer plugin")}async loadSettings(){this.settings=Object.assign({},Ht,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.converter&&this.converter.updateSettings(this.settings)}async importDocx(t,n){var p;this.converter||(this.converter=new Ot(this.settings,this.app.vault));let i=await this.parser.parse(t),r=this.app.workspace.getActiveFile(),o=((p=r==null?void 0:r.parent)==null?void 0:p.path)||"",l=await this.converter.convert(i,o),c=l.markdown;c=be(c),c=ve(c);let h=ge(n),g=`${h}.md`;o&&(g=`${o}/${g}`);let f=g,b=1;for(;this.app.vault.getAbstractFileByPath(f);)f=o?`${o}/${h}_${b}.md`:`${h}_${b}.md`,b++;let d=await this.app.vault.create(f,c);return await this.app.workspace.getLeaf(!1).openFile(d),l}async convertDocxInVault(t){try{new mt.Notice("Converting DOCX file...");let n=await this.app.vault.readBinary(t),i=t.basename,r=await this.importDocx(n,i);r.warnings.length>0?new mt.Notice(`Conversion completed with ${r.warnings.length} warning(s)`):new mt.Notice("DOCX file converted successfully!")}catch(n){console.error("Conversion error:",n),new mt.Notice(`Conversion failed: ${n instanceof Error?n.message:"Unknown error"}`)}}};
/*! Bundled license information:

jszip/dist/jszip.min.js:
  (*!
  
  JSZip v3.10.1 - A JavaScript class for generating and reading zip files
  <http://stuartk.com/jszip>
  
  (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
  Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.
  
  JSZip uses the library pako released under the MIT license :
  https://github.com/nodeca/pako/blob/main/LICENSE
  *)
*/
